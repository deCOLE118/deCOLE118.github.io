<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>TryHackMe房间之Reset | deCOLE's Blog</title><meta name="author" content="deCOLE"><meta name="copyright" content="deCOLE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="TryHackMe房间之Reset">
<meta property="og:type" content="article">
<meta property="og:title" content="TryHackMe房间之Reset">
<meta property="og:url" content="http://example.com/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/index.html">
<meta property="og:site_name" content="deCOLE&#39;s Blog">
<meta property="og:description" content="TryHackMe房间之Reset">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/touxiang.jpg">
<meta property="article:published_time" content="2025-05-08T16:00:00.000Z">
<meta property="article:modified_time" content="2025-05-09T10:49:55.008Z">
<meta property="article:author" content="deCOLE">
<meta property="article:tag" content="TryHackMe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/touxiang.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TryHackMe房间之Reset",
  "url": "http://example.com/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/",
  "image": "http://example.com/img/touxiang.jpg",
  "datePublished": "2025-05-08T16:00:00.000Z",
  "dateModified": "2025-05-09T10:49:55.008Z",
  "author": [
    {
      "@type": "Person",
      "name": "deCOLE",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/touxiang.jpg"><link rel="canonical" href="http://example.com/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TryHackMe房间之Reset',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(img/qccq.jpg);"></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">deCOLE's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">TryHackMe房间之Reset</span></a></span><div id="menus"></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">TryHackMe房间之Reset</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-08T16:00:00.000Z" title="发表于 2025-05-09 00:00:00">2025-05-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-05-09T10:49:55.008Z" title="更新于 2025-05-09 18:49:55">2025-05-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><h1 id="TryHackMe房间之Reset"><a href="#TryHackMe房间之Reset" class="headerlink" title="TryHackMe房间之Reset"></a>TryHackMe房间之Reset</h1><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>对smb还是有点不熟悉，没想到这个smb共享也能打一波强制身份验证来获取哈希，学到了</p>
<p>还有就是bloodhound的使用不够熟练</p>
<h2 id="流程记录"><a href="#流程记录" class="headerlink" title="流程记录"></a>流程记录</h2><p>rustscan扫描结果如下</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824891.png?raw=true" alt="img"></p>
<p>enum4linux 枚举发现</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824214.png?raw=true" alt="img"></p>
<p>用crackmapexec枚举smb，发现域名</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824556.png?raw=true" alt="img"></p>
<p>添加到&#x2F;etc&#x2F;hosts中</p>
<p>再用smbclient枚举一下</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824849.png?raw=true" alt="img"></p>
<p>用空密码尝试连接，发现Data下的onboarding文件夹有一些文件</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824792.png?raw=true" alt="img"></p>
<p>下载到本地</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824976.png?raw=true" alt="img"></p>
<p>发现里面是一些介绍公司相关的？英语不太好</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824581.png?raw=true" alt="img"></p>
<p>在第一个pdf里面看到了一个欢迎的email内容示例，得到初始密码：RessetMe123!</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825780.png?raw=true" alt="img"></p>
<p>所以接下来的思路应该就是：枚举用户然后用初始密码进行密码喷洒</p>
<p>这里靶机中断了，因此ip变动一下</p>
<p>注意到共享文件夹里面的文件会发生变动，这意味着域内用户会访问这个共享文件夹</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825790.png?raw=true" alt="img"></p>
<p>于是我们便可以在这个文件夹中添加一个恶意文件，用户在读取文件时进行强制身份验证，以此来获取ntlm hash</p>
<p>这里用了一个大佬的工具，其他的没尝试过</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Greenwolf/ntlm_theft">https://github.com/Greenwolf/ntlm_theft</a></p>
<p>这个工具可以为我们生成21个用于窃取ntlm哈希的恶意文件</p>
<p>使用命令生成恶意文件，由于不知道哪一个文件会奏效，因此我们选择全部生成</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 ntlm_theft.py <span class="literal">-g</span> all <span class="literal">-s</span> ip <span class="operator">-f</span> folder</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825319.png?raw=true" alt="img"></p>
<p>生成的是*.lnk文件</p>
<p>接下来我们用responder来拦截请求并发送虚假响应，以此获取哈希</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825168.png?raw=true" alt="img"></p>
<p>然后上传我们的文件</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825071.png?raw=true" alt="img"></p>
<p>不一会儿就在responder上得到了一组hash</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825246.png?raw=true" alt="img"></p>
<p>复制粘贴下来用hashcat来破解</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825805.png?raw=true" alt="img"></p>
<p>得到AUTOMATE的密码为Passw0rd1</p>
<p> sudo &#x2F;usr&#x2F;bin&#x2F;fail2ban-client set asterisk-iptables banip 1.1.1.2Plain</p>
<p>然后尝试用evil-winrm连接</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091825625.png?raw=true" alt="img"></p>
<p>拿下第一台主机</p>
<p>接下来我们就要进行横向移动了</p>
<p>打算先用bloodhound</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826136.png?raw=true" alt="img"></p>
<p>然后启动neo4j</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826436.png?raw=true" alt="img"></p>
<p>再启动bloodhound</p>
<p>导入zip得到</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826986.png?raw=true" alt="img"></p>
<p>发现了三个AS-REP Roastable用户，意味着我们可以对他们发起as-rep roasting攻击</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826151.png?raw=true" alt="img"></p>
<p>在查看其中一个TABATHA_BRITT用户的时候，我发现它有一条关系链很可疑，于是选定起点和终点，得到如下攻击路径</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826346.png?raw=true" alt="img"></p>
<p>攻击路径显示，TABTHA_BRIT对SHAWNA_BRAY有GenericAll，这意味着我们可以强制修改它的密码</p>
<p>然后一条链子下去一直到DARLA_WINTERS，我们都可以通过强制修改密码都方式来获取账户</p>
<p>那么剩下就是DALA_WINTERS如何进行攻击的问题了</p>
<p>仔细查看，发现该用户具有约束委派</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826259.png?raw=true" alt="img"></p>
<p>而haystack.thm.corp正好就是我们的域控，因此计划通</p>
<p>思路就是：连续修改密码拿到带有约束委派权限的账户后，对域控发起约束委派攻击</p>
<p>首先是对我们的起点，也就是TABTHA_BRIT发起AS_REP Roasting攻击</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824696.png?raw=true" alt="img"></p>
<p>拿到用户哈希后丢到john破解一下</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091824032.png?raw=true" alt="img"></p>
<p>然后用net rpc来改密码</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826539.png?raw=true" alt="img"></p>
<p>crackmapexec试一试，发现成功了</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826897.png?raw=true" alt="img"></p>
<p>用同样的办法再做几次</p>
<p>现在我们如图</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826814.png?raw=true" alt="img"></p>
<p>改CRUZ_HALL的</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826840.png?raw=true" alt="img"></p>
<p>也是成功拿下</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826185.png?raw=true" alt="img"></p>
<p>然后是最后一个DARLA_WINTERS</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826526.png?raw=true" alt="img"></p>
<p>也是简单拿下了</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826759.png?raw=true" alt="img"></p>
<p>现在只剩下利用约束委派了</p>
<p>用impacket的getST获取cifs服务的票据</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826298.png?raw=true" alt="img"></p>
<p>然后使用krb5ccname环境变量设置ccache</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826539.png?raw=true" alt="img"></p>
<p>后面我们用wmiexec与kerberos认证相结合获取管理员身份的shell就完事了，不知道为什么我这边一直显示没有administrator的ccache</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505091826409.png?raw=true" alt="img"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">deCOLE</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/">http://example.com/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">deCOLE's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/TryHackMe/">TryHackMe</a></div><div class="post-share"><div class="social-share" data-image="/img/touxiang.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BEnterprise/" title="TryHackMe房间之Enterprise"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">TryHackMe房间之Enterprise</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2025/05/27/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BPersisting%20Active%20Directory/" title="TryHackMe房间之Persisting Active Directory"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">TryHackMe房间之Persisting Active Directory</div></div><div class="info-2"><div class="info-item-1">TryHackMe房间之Persisting Active Directory通过凭据进行权限维持获得了域管理员凭据后，我们就可以用特权凭据对低权限凭据进行“降维打击” 通过高权限用户凭据来实现对低权限用户的权限维持 DC同步大型组织中，每个域只有一个域控是不够的，一般会采用多个域控来提高身份验证服务的效率 于是，如何在两个不同的办公室使用相同的凭据进行身份验证成为了一个问题 这里涉及到一个域复制的知识点 每个域控都运行着一个叫做KCC的进程，也就是知识一致性检查器（Knowledge Consistency Checker） KCC的作用就是：为AD林生成复制拓扑，并且通过RPC**（**远程过程调用）自动连接到其他域控，以此同步信息 这也就解释了之前我们在上一个Exploiting AD房间里，更改密码后需要等待几分钟才能进行身份验证，这是因为负责更改密码的域控和我们进行身份验证的域控不是同一个 复制过程称为 DC 同步。不仅仅是 DC 可以启动复制。属于 Domain Admins...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BBilling/" title="TryHackMe房间之Billing"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="info-item-2">TryHackMe房间之Billing</div></div><div class="info-2"><div class="info-item-1">TryHackMe房间之Billing总结从没见过的fail2ban提权，不过倒是启发了以后寻找提权点的思路 找一些自己有权限修改，且以高权限用户身份运行的文件或者服务 流程记录扫端口情况如下  对80端口扫描目录 只扫到个robots.txt  直接访问页面，发现就在&#x2F;mbilling下，于是dirsearch再扫一下  找到一个readme  在readme里面找到了版本号  搜索发现存在历史漏洞 https://github.com/tinashelorenzi/CVE-2023-30258-magnus-billing-v7-exploit 用exp直接拿到shell  找到user.txt，在&#x2F;home&#x2F;magnus下  接下来就是权限提升的环节 先sudo -l查看一下  发现我们能够以root权限执行fail2ban Fail2ban是一个入侵防御软件框架。Fail2Ban...</div></div></div></a><a class="pagination-related" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BEnterprise/" title="TryHackMe房间之Enterprise"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-09</div><div class="info-item-2">TryHackMe房间之Enterprise</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a><a class="pagination-related" href="/2025/05/27/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BPersisting%20Active%20Directory/" title="TryHackMe房间之Persisting Active Directory"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-27</div><div class="info-item-2">TryHackMe房间之Persisting Active Directory</div></div><div class="info-2"><div class="info-item-1">TryHackMe房间之Persisting Active Directory通过凭据进行权限维持获得了域管理员凭据后，我们就可以用特权凭据对低权限凭据进行“降维打击” 通过高权限用户凭据来实现对低权限用户的权限维持 DC同步大型组织中，每个域只有一个域控是不够的，一般会采用多个域控来提高身份验证服务的效率 于是，如何在两个不同的办公室使用相同的凭据进行身份验证成为了一个问题 这里涉及到一个域复制的知识点 每个域控都运行着一个叫做KCC的进程，也就是知识一致性检查器（Knowledge Consistency Checker） KCC的作用就是：为AD林生成复制拓扑，并且通过RPC**（**远程过程调用）自动连接到其他域控，以此同步信息 这也就解释了之前我们在上一个Exploiting AD房间里，更改密码后需要等待几分钟才能进行身份验证，这是因为负责更改密码的域控和我们进行身份验证的域控不是同一个 复制过程称为 DC 同步。不仅仅是 DC 可以启动复制。属于 Domain Admins...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Windows%E5%86%85%E9%83%A8/" title="Windows内部"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">Windows内部</div></div><div class="info-2"><div class="info-item-1">Windows内部进程（Processes）每个进程都提供执行程序所需要的资源 进程具有虚拟空间、可执行代码、系统对象的开放句柄、安全上下文、唯一进程标识符、环境变量、优先级类、最小和最大工作及大小、至少一个执行线程 每个进程都用单个线程（通常称为主线程）启动，但可以从其任何线程创建其他线程    进程组件 作用    私有虚拟地址空间 为进程分配虚拟内存地址   可执行程序 定义存储在虚拟地址空间中的代码和数据   开放句柄 定义进程可以访问的系统资源的句柄   安全上下文 访问令牌，定义用户、权限和其他安全信息   进程ID 进程的唯一数字标识符   线程 计划执行的进程部分   从更底层的层面来看，也就是从虚拟地址空间一层面来解释进程 进程在内存中的组件和用途大概如下    组件 用途    代码(Code) 提供进程执行的代码   全局变量(Global Variables) 存储的变量   进程堆（Process Heap） 定义数据存储的堆   进程资源(Process Resources) 定义进程的更多资源   环境块（Environment...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Windows%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" title="Windows权限维持"><img class="cover" src="/img/twjr.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">Windows权限维持</div></div><div class="info-2"><div class="info-item-1">Windows权限维持篡改非特权账户分配组成员资格​	在这部分任务中，我们假设的前提是：攻击者已经转储了受害者机器的hash,并成功破解了所使用的非特权账户的密码 使得非特权用户能获得管理权限的最直接的方法就是:使其成为Administrators组的一部分 命令如下： 1net localgroup administrators thmuser0 /add   这将允许我们使用RDP、WinRM或者其他任何可用的远程管理服务，来访问服务器 为了降低可疑程度，可用Backup Operators组 此组中的用户将没有管理权限，但是可用读取、写入系统上的任何文件或注册表项，并且忽略任何已配置的DACL。这样我们就可以复制SAM和SYSTEM注册表配置单元的内容，然后恢复所有用户的密码hash，从而使得我们能升到Administrator 在此之前首先我们要将账户添加到Backup Operators组 1C:\&gt; net localgroup &quot;Backup Operators&quot; thmuser1...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Windows%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87/" title="Windows权限提升"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">Windows权限提升</div></div><div class="info-2"><div class="info-item-1">Windows权限提升常见获取密码方式无人值守的 Windows 安装在大量主机上安装 Windows 时，管理员可以使用 Windows 部署服务，该服务允许通过网络将单个操作系统映像部署到多个主机。这些类型的安装称为无人值守安装，因为它们不需要用户交互。此类安装需要使用管理员帐户执行初始设置，最终可能会存储在计算机的以下位置： 12345目录:\无人参与.xmlC:\Windows\Panther\Unattend.xmlC:\Windows\Panther\Unattend\Unattend.xml系统信息文件夹:\Windows\system32\sysprep.infC:\Windows\system32\sysprep\sysprep.xml  作为这些文件的一部分，您可能会遇到凭证： 12345&lt;Credentials&gt;    &lt;Username&gt;Administrator&lt;/Username&gt;    &lt;Domain&gt;thm.local&lt;/Domain&gt;   ...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">deCOLE</div><div class="author-info-description">凡夫俗子岂识我，非到末路不甘休</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">So when you go</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset"><span class="toc-number">1.</span> <span class="toc-text">TryHackMe房间之Reset</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.1.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E8%AE%B0%E5%BD%95"><span class="toc-number">1.2.</span> <span class="toc-text">流程记录</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/27/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BPersisting%20Active%20Directory/" title="TryHackMe房间之Persisting Active Directory">TryHackMe房间之Persisting Active Directory</a><time datetime="2025-05-26T16:00:00.000Z" title="发表于 2025-05-27 00:00:00">2025-05-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BBilling/" title="TryHackMe房间之Billing">TryHackMe房间之Billing</a><time datetime="2025-05-08T16:00:00.000Z" title="发表于 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BEnterprise/" title="TryHackMe房间之Enterprise">TryHackMe房间之Enterprise</a><time datetime="2025-05-08T16:00:00.000Z" title="发表于 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/" title="TryHackMe房间之Reset">TryHackMe房间之Reset</a><time datetime="2025-05-08T16:00:00.000Z" title="发表于 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/18/Pearcmd%E6%80%BB%E7%BB%93%E5%8F%8A%E5%88%A9%E7%94%A8/" title="Pearcmd总结及利用">Pearcmd总结及利用</a><time datetime="2025-03-17T16:00:00.000Z" title="发表于 2025-03-18 00:00:00">2025-03-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By deCOLE</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>